
<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <title>DD_XIE的学习笔记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="">
    <meta name="description" content="前端学习">
    
        <link rel="icon" href="/favicon.ico">
    
    
        
            <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
        
            <link rel="stylesheet" href="/css/stage.css">
        
            <link rel="stylesheet" href="/css/avatar-bg.css">
        
    
</head>
</html>
<body>
<header id="header">
    <div class="menu">
        <i class="fa fa-bars"></i>
    </div>
    <div class="header-main">
        <h1><a href="/">DD_XIE的学习笔记</a></h1>
    </div>
    <div id="nav">
        <div class="nav-img" id="nav-img"></div>
        <div class="sentences">
            How goes the world with you?
        </div>
    </div>
</header>

<div id="content-outer">
    <div id="content-inner">
        <div class="clearfix">
    
    <div id="recent-posts">
        
            <div class="post-item">
                <h1>
                    <a href="/2019/12/26/ES6/">
                        ES6
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-12-26T14:15:19.090Z">
                            2019-12-26
                        </time>
                    
                    
                </div>
                
                    
                
                <div class="readmore">
                    <a href="/2019/12/26/ES6/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/12/26/hexo/">
                        hexo学习
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-12-26T14:15:19.090Z">
                            2019-12-26
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/hexo/">hexo</a></li></ul>
                </div>
                
                     <font color="red" size="5"><a href="https://xdd7130.github.io" target="_blank" rel="noopener">https://xdd7130.github.io</a></font><font color="red" size="5">若存储在master中,xdd7130不可更改,必须和github的username一致.</font>

<h2 id="为博客添加访问量"><a href="#为博客添加访问量" class="headerlink" title="为博客添加访问量"></a>为博客添加访问量</h2><p>参考：<a href="https://blog.csdn.net/qw8880000/article/details/80235391" target="_blank" rel="noopener">https://blog.csdn.net/qw8880000/article/details/80235391</a><br>这里使用的是不蒜子提供的阅读统计功能，使用的hexo主题是stage。</p>
<h3 id="添加是否开启统计功能的配置"><a href="#添加是否开启统计功能的配置" class="headerlink" title="添加是否开启统计功能的配置"></a>添加是否开启统计功能的配置</h3><p>找到stage主题的配置文件themes/stage/_config.yml，找到原来的footer字段，加入一个配置，这里我们叫它counter吧，即<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">footer:</span><br><span class="line">  <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">  <span class="comment"># visitors count</span></span><br><span class="line">  counter: <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>修改stage主题的模板文件<br>由于是把访问量统计放在网页的footer，所以我们需要修改的模板文件是theme/stage/layout/_partials/footer.ejs。<br>我们在合适的位置加入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> theme.footer.counter %&#125;</span><br><span class="line">    &lt;script async src=<span class="string">"//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;span id=<span class="string">"busuanzi_container_site_pv"</span>&gt;总访问量&lt;span id=<span class="string">"busuanzi_value_site_pv"</span>&gt;&lt;/span&gt;次&lt;/span&gt;</span><br><span class="line">    &lt;span class=<span class="string">"post-meta-divider"</span>&gt;|&lt;/span&gt;</span><br><span class="line">    &lt;span id=<span class="string">"busuanzi_container_site_uv"</span>&gt;总访客&lt;span id=<span class="string">"busuanzi_value_site_uv"</span>&gt;&lt;/span&gt;人&lt;/span&gt;</span><br><span class="line">    &lt;span class=<span class="string">"post-meta-divider"</span>&gt;|&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
<h4 id="Hexo-github搭建博客"><a href="#Hexo-github搭建博客" class="headerlink" title="Hexo+github搭建博客"></a>Hexo+github搭建博客</h4><p>1、  npm install -g hexo<br>错误：npm WARN deprecated <a href="mailto:titlecase@1.1.2" target="_blank" rel="noopener">titlecase@1.1.2</a>: no longer maintained<br>解决：安装淘宝镜像<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure></p>
<p>2、  初始化(hexo init)<br>Hexo文件夹必须为空。<br>3、  hexo g 生成静态文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s 搭建本地服务查看localhost:4000</span><br></pre></td></tr></table></figure></p>
<p>4、  hexo d<br>问题：$ hexo d： ERROR Deployer not found: git<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-deployer-git</span><br></pre></td></tr></table></figure></p>
<p>部署本地文件到github<br>既然Repository已经创建了，当然是先把博客放到Github上去看看效果。编辑E：\hexo下的_config.yml文件，建议使用Notepad++。<br>在_config.yml最下方，添加如下配置(命令中的第一个tengj为Github的用户名,第二个tengj为之前New的Repository的名字,记得改成自己的。另外记得一点，hexo的配置文件中任何’:’后面都是带一个空格的),如果配置以下命令出现ERROR Deployer not found : github，则参考上文的解决方法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy: </span><br><span class="line">    <span class="built_in">type</span>: git</span><br><span class="line">    repository: https://github.com/tengj/tengj.github.io.git</span><br><span class="line">    branch: master</span><br></pre></td></tr></table></figure></p>
<p>配置_config.yml并保存。如果你是第一次使用Github或者是已经使用过，但没有配置过SSH，则可能需要配置一下:<br>在Git Bash输入以下指令（任意位置点击鼠标右键），检查是否已经存在了SSH keys。<br>ls -al ~/.ssh<br>如果不存在就没有关系，如果存在的话，直接删除.ssh文件夹里面所有文件：<br>输入以下指令（邮箱就是你注册Github时候的邮箱）后，回车，出现提示让你输入的时候直接先回车，好像需要3次，如下图所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"2621324849@qq.com"</span></span><br></pre></td></tr></table></figure></p>
<p>然后键入以下指令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-agent -s</span><br></pre></td></tr></table></figure></p>
<p>继续输入指令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-add ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure></p>
<p>输入之后，在我这里是出错了，不知道你的有没有出错。<br>如果你的也是这样子出错了的话，就输入以下指令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> `ssh-agent -s`</span><br><span class="line">ssh-add</span><br></pre></td></tr></table></figure></p>
<p>到了这一步，就可以添加SSH key到你的Github账户了。键入以下指令，拷贝Key（先拷贝了，等一下可以直接粘贴，不放心的在执行下面命令后，先黏贴在记事本上）：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clip &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure></p>
<p>然后到Github里面，点击右上角的设置图标Settings,找到SSH keys,Ttile随便你命名，Key就黏贴上你刚才复制的key,然后点Add SSH key，最后会让你重新输入下gitHub的密码<br>最后还是测试一下吧，键入以下命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></p>
<p>你可能会看到有警告，没事，输入“yes”就好<br>以上就表示SSH配置好了，执行以下命令部署到Github上。<br>hexo g<br>hexo d<br>如果执行hexo d命令报下名错：<br>就先安装一下hexo-deployer-git这个模块：npm install hexo-deployer-git –save<br>安装好了继续执行hexo d部署命令，输入gitHub的账号密码，就可以访问了。</p>
<h4 id="问题：博客引入图片"><a href="#问题：博客引入图片" class="headerlink" title="问题：博客引入图片"></a>问题：博客引入图片</h4><p>解决办法<br>1.首先把blog（hexo）目录下的_config.yml里的psot_asset_folder:设置为true</p>
<p>2.在blog（hexo）目录下执行:</p>
<p>npm install hexo-asset-image –save<br>3.在blog（hexo）目录下Git Bash Here，运行hexo n “博客名”来生成md博客时，会在_post目录下看到一个与博客同名的文件夹。</p>
<p>4.将想要上传的图片先扔到文件夹下，然后在博客中使用markdown的格式引入图片：</p>
<p><img src="/2019/12/26/hexo/xxxx/图片名.jpg" alt="你想要输入的替代文字"><br>ps：因为博客名和文件夹名字相同，所以不需要绝对路径，只要xxxx是文件夹的名字就可以了。</p>
<p>5.然后，使用hexo g部署的时候，进入public\2018\04\19\index.html文件中查看相关字段，可以发现html标签内的语句是img src = “2018/04/19/xxxx/图片名.jpg”而不是img src=”xxxx.图片名.jpg”，这就成功了，当然前面步骤操作正确的话，这一步也不用检查。</p>

                
                <div class="readmore">
                    <a href="/2019/12/26/hexo/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/09/22/login/">
                        vuex+node+express+token登录
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-09-22T08:38:30.000Z">
                            2019-09-22
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/VUE/">VUE</a></li></ul>
                </div>
                
                    <h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>1、第一次登录的时候，前端调后端的登陆接口，发送用户名和密码</p>
<p>2、后端收到请求，验证用户名和密码，验证成功，就给前端返回一个token</p>
<p>3、前端拿到token，将token存储到localStorage和vuex中，并跳转路由页面</p>
<p>4、前端每次跳转路由，就判断 localStroage 中有无 token ，没有就跳转到登录页面，有则跳转到对应路由页面</p>
<p>5、每次调后端接口，都要在请求头中加token</p>
<p>6、后端判断请求头中有无token，有token，就拿到token并验证token，验证成功就返回数据，验证失败（例如：token过期）就返回401，请求头中没有token也返回401</p>
<p>7、如果前端拿到状态码为401，就清除token信息并跳转到登录页面</p>
<h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><p>1、路由守卫导航<br>2、localStorage及其他前端存储（见基础前端）<br>3、防抖和节流（token过期）<br>4、后端接口调用<br>5、node.js、mysql、git、express、element-UI、vuex、vue-router、jsonwebtoken</p>
<h3 id="知识点解释"><a href="#知识点解释" class="headerlink" title="知识点解释"></a>知识点解释</h3><h4 id="路由守卫导航"><a href="#路由守卫导航" class="headerlink" title="路由守卫导航"></a>路由守卫导航</h4><p>vue-router 的导航钩子，主要用来作用是拦截导航，让他完成跳转或取消。<br>有三种方式可以植入路由导航过程中：</p>
<ul>
<li><p>全局导航守卫<br>1、全局前置守卫 router.beforeEach(fn)<br>2、全局的解析守卫(不常用)<br>3、全局的后置守卫 router.afterEach(fn)<br>（可以做一些用户友好提示、与全局前置守卫参数相同）</p>
</li>
<li><p>路由独享守卫<br>1、路由独享守卫 beforeEnter(to,from,next)<br>  （a、写在路由表中的守卫钩子<br>  b、针对的是和当前路由相关的，那么其他与之不相关的路由，它是无法监听它的变化情况的<br>  c、可用于用户权限管理<br>  d、与全局前置守卫参数相同）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const routes = [</span><br><span class="line">     &#123;</span><br><span class="line">         path: <span class="string">'/'</span>,</span><br><span class="line">         redirect: <span class="string">'/home'</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         path: <span class="string">'/home'</span>,</span><br><span class="line">         component: Home</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         path: <span class="string">'/category'</span>,</span><br><span class="line">         component: Category,</span><br><span class="line">         beforeEnter ( to,from,next ) &#123;</span><br><span class="line">         alert(<span class="string">'您要进入吗'</span>)</span><br><span class="line">         next()</span><br><span class="line">         //业务： 用户权限管理</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         path: <span class="string">'**'</span>,</span><br><span class="line">         redirect: <span class="string">'/error'</span></span><br><span class="line">     &#125;</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure>
</li>
<li><p>组件内守卫<br>1、组件内的前置守卫beforeRouteEnter((to,from,next)=&gt;{})<br>导航进入组件时，调用因为组件此时没有创建，所以没有this,this是访问不到的，如果非要访问this,必须通过 next(vm=&gt;{})访问。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">next(vm =&gt; &#123; //vm指的就是组件</span><br><span class="line">   const result = JSON.parse(res.data.slice(7,-1)).rp_result.categorys</span><br><span class="line">   vm.<span class="variable">$set</span>(vm.category,<span class="string">'categorys'</span>,result)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>2、组件内的后置守卫beforeRouteEnter((to,from,next)=&gt;{})<br>(a)离开组件时，调用<br>(b)this是可以访问到<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteLeave (to, from, next) &#123;</span><br><span class="line">    //我们现在已经要离开这个组件，那么这个组件身上的数据和方法等内容我们肯定可以获取到，也就是说这里可以使用 this</span><br><span class="line">    <span class="keyword">if</span>( this.username || this.password)&#123;</span><br><span class="line">    <span class="keyword">if</span>( confirm(<span class="string">'您已经填写结束了吗?'</span>))&#123;</span><br><span class="line">        next()</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        next(<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    	next()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>3、组件内的更新守卫（ 路由传参和路由的接参 ）<br>（a）在当前路由改变，但是该组件被复用时调用<br>（b）举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，<br>（c）由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。<br>（d）可以访问组件实例 this<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteUpdate ( to,from,next ) &#123; //动态路由用</span><br><span class="line">     console.log(<span class="string">'路由改变了'</span>)</span><br><span class="line">     next()</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p> 1、3种类型 7个路由监听钩子<br> 2、业务：<br>监听整个项目的路由变化情况——全局的前置守卫<br>监听某个路由的变化情况——路由的独享守卫<br>监听的路由组件的路由变化情况——组件内的导航守卫</p>
<p>#### </p>
<h3 id="实例实现"><a href="#实例实现" class="headerlink" title="实例实现"></a>实例实现</h3><p>待补充。。。</p>

                
                <div class="readmore">
                    <a href="/2019/09/22/login/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/09/11/node7/">
                        MySQL
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-09-11T07:11:01.000Z">
                            2019-09-11
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Node/">Node</a></li></ul>
                </div>
                
                    <h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><h4 id="mysql安装"><a href="#mysql安装" class="headerlink" title="mysql安装"></a>mysql安装</h4><p>参考：<a href="https://www.cnblogs.com/laumians-notes/p/9069498.html" target="_blank" rel="noopener">https://www.cnblogs.com/laumians-notes/p/9069498.html</a></p>
<p>Navicat数据库管理工具:<a href="https://blog.csdn.net/a599174211/article/details/82795658" target="_blank" rel="noopener">https://blog.csdn.net/a599174211/article/details/82795658</a></p>
<h3 id="nodeJS操作MySQL"><a href="#nodeJS操作MySQL" class="headerlink" title="nodeJS操作MySQL"></a>nodeJS操作MySQL</h3><p>nodeJS默认不支持MySQL,需要第三方工具来驱动，这里用mysql驱动。</p>
<ul>
<li>npm install mysql</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const mysql = require(<span class="string">'mysql'</span>);</span><br><span class="line"></span><br><span class="line">1.连接</span><br><span class="line">//createConnection(哪台服务器，用户名，密码，库)</span><br><span class="line">var db = mysql.createConnection(host:<span class="string">'localhost'</span>,port:<span class="string">'3306'</span>,user:<span class="string">'root'</span>,password:<span class="string">'123456'</span>,database:<span class="string">'my_db'</span>,)；</span><br><span class="line"></span><br><span class="line">2.查询</span><br><span class="line">//query(干啥，回调函数)</span><br><span class="line">db.query(<span class="string">"SELECT * FROM `user_table`;"</span>,(err,data)=&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)</span><br><span class="line">        console.log(<span class="string">'出错了'</span>，err)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        console.log(<span class="string">'成功了'</span>，data)</span><br><span class="line">        console.log(JSON.stringify(data))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="SQL标准写法："><a href="#SQL标准写法：" class="headerlink" title="SQL标准写法："></a>SQL标准写法：</h3><p>1.关键字大写<br>2.库、表、字段需加上饭单引号<code></code><br>SQL四大语句：增删改查<br>增：INSERT<br>INSERT INTO 表（字段列表） VALUES (值列表)<br>INSERT INTO <code>user_table</code>（<code>ID</code>,<code>username</code>,<code>password</code>）VALUES (<code>0</code>,<code>blue2</code>,<code>987654</code>) VALUES (值列表)<br>删：DELETE<br>改：UPDATE<br>查：SELECT</p>

                
                <div class="readmore">
                    <a href="/2019/09/11/node7/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/09/10/node6/">
                        jade、ejs模板库
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-09-10T08:36:44.000Z">
                            2019-09-10
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Node/">Node</a></li></ul>
                </div>
                
                    <p>模板引擎：生成页面</p>
<p>主要的：</p>
<blockquote>
<p>jade-破坏式、侵入式、强依赖<br>ejs-温和式、非侵入式、 弱依赖</p>
</blockquote>
<h3 id="安装jade插件"><a href="#安装jade插件" class="headerlink" title="安装jade插件"></a>安装jade插件</h3><p>npm install jade</p>
<p>jade写法:</p>
<ul>
<li>根据缩进，规定层级</li>
<li>属性放在()里面，逗号分隔</li>
<li>a标签文本内容前有一个空格</li>
<li>style两种写法：普通属性写法;用json。</li>
<li>class两种写法:普通属性写法;用数组。</li>
<li>&amp;attribute</li>
</ul>
<p>jade1.js<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const jade = require(<span class="string">'jade'</span>);</span><br><span class="line">//字符串：var str = jade.render(<span class="string">'njfnejrfbjreknve'</span>);</span><br><span class="line">//文件：</span><br><span class="line">var str = jade.renderfile(<span class="string">'./views/1.jade'</span>,&#123;pertty:<span class="literal">true</span>&#125;);</span><br><span class="line">console.log(str);</span><br></pre></td></tr></table></figure></p>
<p>1.jade<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">    head</span><br><span class="line">        style</span><br><span class="line">        script(src=<span class="string">"a.js"</span>)</span><br><span class="line">        link(href=<span class="string">'a.css'</span>,rel=<span class="string">'stylesheet'</span>)</span><br><span class="line">    body</span><br><span class="line">        div.box</span><br><span class="line">        div<span class="comment">#div1</span></span><br><span class="line">        div(style=<span class="string">"width:200px;height:200px;"</span>,class=<span class="string">"aaa bbb"</span>)</span><br><span class="line">            ul</span><br><span class="line">                li</span><br><span class="line">                    input(<span class="built_in">type</span>=<span class="string">'text'</span>,id=<span class="string">"test1"</span>)</span><br><span class="line">                li</span><br><span class="line">                    a(href=<span class="string">'http://baidu.com'</span>) 百度</span><br><span class="line">                li</span><br><span class="line">            div(style=&#123;width:<span class="string">'200px'</span>,height:<span class="string">'200px'</span>;&#125;,class=[<span class="string">'aaa'</span>,<span class="string">'bbb'</span>])</span><br></pre></td></tr></table></figure></p>
<h3 id="jade模板库高级语法"><a href="#jade模板库高级语法" class="headerlink" title="jade模板库高级语法"></a>jade模板库高级语法</h3><ul>
<li>识别单双标签，自定义标签默认为双标签。<br><img src="/2019/09/10/node6/01.png" alt="01.png"></li>
<li>“|”或”.”用来原样输出东西。<br><img src="/2019/09/10/node6/02.png" alt="02.png"><br><img src="/2019/09/10/node6/03.png" alt="03.png"></li>
<li>include引入文件<br><img src="/2019/09/10/node6/04.png" alt="04.png"></li>
<li><p>使用变量：#{}  或”=”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.js</span><br><span class="line">    const jade= require(<span class="string">'jade'</span>);</span><br><span class="line">    console.log(jade.renderfile(<span class="string">'./view/1.jade'</span>,&#123;pretty:<span class="literal">true</span>,name:<span class="string">'blue'</span>&#125;))</span><br><span class="line"></span><br><span class="line">1.jade</span><br><span class="line">    div 我的名字<span class="comment">#&#123;name&#125;</span></span><br><span class="line">    div=name</span><br></pre></td></tr></table></figure>
</li>
<li><p>“-“代表：我是一段代码<br><img src="/2019/09/10/node6/05.png" alt="05.png"></p>
</li>
<li><p>循环：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.jade</span><br><span class="line">html </span><br><span class="line">    head</span><br><span class="line">        body</span><br><span class="line">            .<span class="keyword">for</span>(var i=0;i&lt;arr.length;i++)</span><br><span class="line">            div=arr[i]</span><br><span class="line"></span><br><span class="line">1.js</span><br><span class="line">console.log(jade.renderfile(<span class="string">'./view/1.jade'</span>,&#123;pretty:<span class="literal">true</span>,</span><br><span class="line">    arr:[<span class="string">'aaa'</span>,<span class="string">'bbb'</span>,<span class="string">'ccc'</span>]</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
</li>
<li><p>非转义：标签原样输出：！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.jade</span><br><span class="line">html </span><br><span class="line">    head</span><br><span class="line">        body</span><br><span class="line">            div!=content</span><br><span class="line"></span><br><span class="line">1.js</span><br><span class="line">console.log(jade.renderfile(<span class="string">'./view/1.jade'</span>,&#123;pretty:<span class="literal">true</span>,</span><br><span class="line">    content:<span class="string">'&lt;h2&gt;mwenfoirefwo&lt;/h2&gt;'</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成html文件<br><img src="/2019/09/10/node6/06.png" alt="06.png"></p>
</li>
</ul>
<h3 id="安装ejs插件"><a href="#安装ejs插件" class="headerlink" title="安装ejs插件"></a>安装ejs插件</h3><p>npm install ejs</p>
<p>ejs1.js<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const ejs = require(<span class="string">'ejs'</span>);</span><br><span class="line">var str = ejs.renderfile(<span class="string">'./views/1.ejs'</span>,&#123;name:<span class="string">'blue'</span>&#125;,<span class="keyword">function</span>(err,data)&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)</span><br><span class="line">        console.log(<span class="string">'编译失败'</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        console.log(data)</span><br><span class="line">&#125;);</span><br><span class="line">console.log(str);</span><br></pre></td></tr></table></figure></p>
<p>1.ejs<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    我的名字叫：&lt;%= name %&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="ejs模板库高级语法"><a href="#ejs模板库高级语法" class="headerlink" title="ejs模板库高级语法"></a>ejs模板库高级语法</h3><ul>
<li>灵活，支持各类型数据<br><img src="/2019/09/10/node6/07.png" alt="07.png"></li>
<li>循环<br><img src="/2019/09/10/node6/08.png" alt="08.png"></li>
<li>“=”转义输出,”-“非转义输出</li>
<li>&lt;% include ./a.txt %&gt;<br><img src="/2019/09/10/node6/09.png" alt="09.png"></li>
</ul>

                
                <div class="readmore">
                    <a href="/2019/09/10/node6/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/23/时序动画/">
                        时序动画
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-23T08:39:42.000Z">
                            2019-08-23
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <h4 id="补充1-2019-08-29"><a href="#补充1-2019-08-29" class="headerlink" title="补充1:2019-08-29"></a>补充1:2019-08-29</h4><blockquote>
<p>发布服务前，设置时区</p>
</blockquote>
<p><img src="/2019/08/23/时序动画/02.png" alt="02.png"></p>
<p>效果图：<br><img src="/2019/08/23/时序动画/01.png" alt="01.png"></p>
<h4 id="步骤一：数据准备"><a href="#步骤一：数据准备" class="headerlink" title="步骤一：数据准备"></a>步骤一：数据准备</h4><p>拖拉机数据：时间2019/6/7 7:59:00-2019/6/713:52:00<br>目标数据：时间2019/6/7 8:00:00-2019/6/713:52:00 </p>
<p>注意：所有的数据需放在地理数据库里，否则日期后的时分秒被自动截去删除。</p>
<h4 id="步骤二：制图表达"><a href="#步骤二：制图表达" class="headerlink" title="步骤二：制图表达"></a>步骤二：制图表达</h4><p>将拖拉机数据转为制图表达，重新为RULEID赋值，这里我全赋值为6，不能赋值为0哦。<br>目标数据线分为五个等级，再转为制图表达，RULEID是否重新赋值视情况而定。(能够满足步骤四的分级)</p>
<h4 id="步骤三：合并merge"><a href="#步骤三：合并merge" class="headerlink" title="步骤三：合并merge"></a>步骤三：合并merge</h4><p>将两个制图表达数据合并。</p>
<h4 id="步骤四：分级"><a href="#步骤四：分级" class="headerlink" title="步骤四：分级"></a>步骤四：分级</h4><p>将步骤三合并的文件进行分级，这里分为六级（包括整个图层），其中第六级用来渲染拖拉机符号。</p>
<h4 id="步骤五：再次制图表达"><a href="#步骤五：再次制图表达" class="headerlink" title="步骤五：再次制图表达"></a>步骤五：再次制图表达</h4><p>将分级后的文件再次制作制图表达，对第六级进行符号渲染。</p>
<h4 id="步骤六：将文件导入到数据库"><a href="#步骤六：将文件导入到数据库" class="headerlink" title="步骤六：将文件导入到数据库"></a>步骤六：将文件导入到数据库</h4><h4 id="步骤七：从数据库拉去数据设置timeslider属性，发布服务"><a href="#步骤七：从数据库拉去数据设置timeslider属性，发布服务" class="headerlink" title="步骤七：从数据库拉去数据设置timeslider属性，发布服务"></a>步骤七：从数据库拉去数据设置timeslider属性，发布服务</h4><h4 id="步骤八：调用服务"><a href="#步骤八：调用服务" class="headerlink" title="步骤八：调用服务"></a>步骤八：调用服务</h4><p>使用动态图层，要素服务调用，符号不渲染。</p>
<h4 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span>&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"initial-scale=1, maximum-scale=1,user-scalable=no"</span>&gt;</span><br><span class="line">    &lt;title&gt;Recent Earthquakes&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">    &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://js.arcgis.com/3.29/dijit/themes/claro/claro.css"</span>&gt;</span><br><span class="line">    &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://js.arcgis.com/3.29/esri/css/esri.css"</span>&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      html, body &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">      &#125;</span><br><span class="line">      .dijitBorders&#123;</span><br><span class="line">        margin:5px 5px 5px 5px; </span><br><span class="line">        border:solid thin <span class="comment">#9CAA9C;</span></span><br><span class="line">       -moz-border-radius: 4px;</span><br><span class="line">      &#125;</span><br><span class="line">      .labelText&#123;</span><br><span class="line">        color:<span class="comment">#9CAA9C;</span></span><br><span class="line">        font-size:12pt;  </span><br><span class="line">        font-family:<span class="string">"Tahoma"</span>;</span><br><span class="line">        margin:5px;</span><br><span class="line">      &#125;</span><br><span class="line">      .headerText&#123;</span><br><span class="line">        color:<span class="comment">#9CAA9C;</span></span><br><span class="line">        font-size:16pt;</span><br><span class="line">        font-weight:bold;</span><br><span class="line">        font-family: <span class="string">"Tahoma"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script src=<span class="string">"https://js.arcgis.com/3.29/"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      var map,timeExtent;</span><br><span class="line">      require([</span><br><span class="line">        <span class="string">"esri/map"</span>,<span class="string">"esri/layers/ArcGISDynamicMapServiceLayer"</span>, <span class="string">"esri/layers/FeatureLayer"</span>, <span class="string">"esri/TimeExtent"</span>, <span class="string">"esri/layers/TimeInfo"</span>,</span><br><span class="line">        <span class="string">"esri/renderers/ClassBreaksRenderer"</span>,</span><br><span class="line">        <span class="string">"esri/symbols/SimpleMarkerSymbol"</span>, <span class="string">"esri/symbols/SimpleLineSymbol"</span>,</span><br><span class="line">        <span class="string">"esri/dijit/editing/TemplatePicker"</span>, <span class="string">"esri/dijit/TimeSlider"</span>,</span><br><span class="line">        <span class="string">"esri/renderers/TimeClassBreaksAger"</span>, <span class="string">"esri/renderers/TemporalRenderer"</span>,</span><br><span class="line">        <span class="string">"dojo/parser"</span>, <span class="string">"dojo/_base/array"</span>, <span class="string">"esri/Color"</span>, <span class="string">"dojo/dom"</span>, <span class="string">"dojo/date"</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="string">"dijit/layout/BorderContainer"</span>, <span class="string">"dijit/layout/ContentPane"</span>, <span class="string">"dojo/domReady!"</span></span><br><span class="line">      ], <span class="keyword">function</span>(</span><br><span class="line">        Map, ArcGISDynamicMapServiceLayer,FeatureLayer, TimeExtent, TimeInfo,</span><br><span class="line">        ClassBreaksRenderer,</span><br><span class="line">        SimpleMarkerSymbol, SimpleLineSymbol,</span><br><span class="line">        TemplatePicker, TimeSlider,</span><br><span class="line">        TimeClassBreaksAger, TemporalRenderer,</span><br><span class="line">        parser, arrayUtils, Color, dom, date</span><br><span class="line">      ) &#123;</span><br><span class="line">        parser.parse();</span><br><span class="line"></span><br><span class="line">        map = new Map(<span class="string">"map"</span>, &#123;</span><br><span class="line">          basemap: <span class="string">"satellite"</span>,</span><br><span class="line">          center: [114.0143, 34.11075],</span><br><span class="line">          slider: <span class="literal">false</span>,</span><br><span class="line">          zoom:15</span><br><span class="line">        &#125;);</span><br><span class="line">        //边界</span><br><span class="line">          var research_scope = new ArcGISDynamicMapServiceLayer(<span class="string">"http://localhost:6080/arcgis/rest/services/Henan_S/research_scope1/MapServer"</span>,&#123;<span class="string">"id"</span>:<span class="string">"100000"</span>&#125;);</span><br><span class="line">        map.on(<span class="string">"load"</span>, mapLoaded);   </span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="function"><span class="title">mapLoaded</span></span>() &#123;</span><br><span class="line">            var SOMtlj = new ArcGISDynamicMapServiceLayer(<span class="string">"http://localhost:6080/arcgis/rest/services/Henan_S/PH1_TLJ/MapServer"</span>,&#123;<span class="string">"id"</span>:<span class="string">"3"</span>&#125;);</span><br><span class="line">            SOMtlj.on(<span class="string">"load"</span>, featureLayerLoaded);</span><br><span class="line">            map.addLayer(SOMtlj);</span><br><span class="line">            map.addLayer(research_scope);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="function"><span class="title">featureLayerLoaded</span></span>() &#123;</span><br><span class="line">          // create time slider</span><br><span class="line">          var timeSlider = new TimeSlider(&#123; style: <span class="string">"width: 100%;"</span>&#125;, dom.byId(<span class="string">"timeSliderDiv"</span>));</span><br><span class="line">          map.setTimeSlider(timeSlider);</span><br><span class="line"></span><br><span class="line">          timeExtent = new TimeExtent();</span><br><span class="line">          </span><br><span class="line">          // 设置时区后，开始时间和结束时间</span><br><span class="line">          //timeExtent.startTime = new Date(<span class="string">"2019/06/06 23:59:00 UTC"</span>);</span><br><span class="line">          //timeExtent.endTime = new Date(<span class="string">"2019/06/07 05:52:00 UTC"</span>);</span><br><span class="line"></span><br><span class="line">          timeSlider.setThumbCount(1);</span><br><span class="line">          timeSlider.createTimeStopsByTimeInterval(timeExtent, 1, <span class="string">"esriTimeUnitsMinutes"</span>); </span><br><span class="line">        </span><br><span class="line">          timeSlider.setThumbIndexes([0]);</span><br><span class="line">          timeSlider.on(<span class="string">"time-extent-change"</span>, displayTimeInfo);</span><br><span class="line">          timeSlider.startup();</span><br><span class="line">           // timeSlider.play();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> displayTimeInfo(timeExtent) &#123;</span><br><span class="line">          var info = timeExtent.endTime;</span><br><span class="line">          dom.byId(<span class="string">"timeInfo"</span>).innerHTML = info;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body class=<span class="string">"claro"</span>&gt;</span><br><span class="line">    &lt;div id=<span class="string">"mainWindow"</span> </span><br><span class="line">         data-dojo-type=<span class="string">"dijit/layout/BorderContainer"</span> </span><br><span class="line">         data-dojo-propx=<span class="string">"design:'sidebar', gutters:true"</span> </span><br><span class="line">         style=<span class="string">"width:100%; height:100%;"</span>&gt;</span><br><span class="line">     &lt;div id=<span class="string">"header"</span> </span><br><span class="line">          data-dojo-type=<span class="string">"dijit/layout/ContentPane"</span> </span><br><span class="line">          data-dojo-props=<span class="string">"region:'top'"</span> </span><br><span class="line">          class=<span class="string">"dijitBorders"</span> style=<span class="string">"height:100px;"</span>&gt;</span><br><span class="line">      &lt;center&gt;</span><br><span class="line">        &lt;span class=<span class="string">"headerText"</span>&gt;采样时序&lt;/span&gt;</span><br><span class="line">        &lt;div id=<span class="string">"timeInfo"</span> class=<span class="string">"labelText"</span>&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div id=<span class="string">"timeSliderDiv"</span> &gt;&lt;/div&gt;</span><br><span class="line">      &lt;/center&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;div id=<span class="string">"map"</span> data-dojo-type=<span class="string">"dijit/layout/ContentPane"</span> </span><br><span class="line">           data-dojo-props=<span class="string">"region:'center'"</span> class=<span class="string">"dijitBorders"</span> </span><br><span class="line">           style=<span class="string">"background-color:inherit;"</span>&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;div id=<span class="string">"right"</span> data-dojo-type=<span class="string">"dijit/layout/ContentPane"</span> </span><br><span class="line">           data-dojo-props=<span class="string">"region:'left'"</span> </span><br><span class="line">           style=<span class="string">"width:100px;font-size:small;"</span>&gt;</span><br><span class="line"></span><br><span class="line">          &lt;center&gt;&lt;span class=<span class="string">"labelText"</span>&gt;Age&lt;/span&gt;&lt;/center&gt;</span><br><span class="line">          &lt;div id=<span class="string">"ageDiv"</span> class=<span class="string">"dijitBorders"</span>&gt;&lt;/div&gt;</span><br><span class="line">          &lt;center&gt;&lt;span class=<span class="string">"labelText"</span>&gt;Magnitude&lt;/span&gt;&lt;/center&gt;</span><br><span class="line">          &lt;div id=<span class="string">"magnitudeDiv"</span> class=<span class="string">"dijitBorders"</span> &gt;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      </span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

                
                <div class="readmore">
                    <a href="/2019/08/23/时序动画/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/15/vuex/">
                        vuex
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-15T03:20:43.000Z">
                            2019-08-15
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/VUE/">VUE</a></li></ul>
                </div>
                
                    <p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式<br>大型项目，涉及复杂的交互时，用vuex</p>

                
                <div class="readmore">
                    <a href="/2019/08/15/vuex/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/13/node5/">
                        Express
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-13T03:07:47.000Z">
                            2019-08-13
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Node/">Node</a></li></ul>
                </div>
                
                    <h3 id="Express框架"><a href="#Express框架" class="headerlink" title="Express框架"></a>Express框架</h3><p>1.依赖中间件<br>2.接受请求<br>3.非破坏式的<br>4.static用法</p>
<h4 id="安装、配置、接受请求、响应"><a href="#安装、配置、接受请求、响应" class="headerlink" title="安装、配置、接受请求、响应"></a>安装、配置、接受请求、响应</h4><p>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express</span><br></pre></td></tr></table></figure></p>
<p>使用</p>
<ul>
<li>创建服务</li>
<li>监听</li>
<li>处理请求<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">var server = express();</span><br><span class="line">server.use(<span class="string">'/a.html'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    res.send(<span class="string">'abc'</span>);                          //send和write类似</span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br><span class="line">server.use(<span class="string">'/b.html'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    res.send(<span class="string">'123'</span>);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>express保留了原生的功能，添加了一些方法，增强原有的功能。</p>
<h4 id="3种方法"><a href="#3种方法" class="headerlink" title="3种方法"></a>3种方法</h4><p>get(处理get请求)\post(处理post请求)\use(get,post均可)。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">var server = express();</span><br><span class="line">server.get(<span class="string">'/'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    console.log(<span class="string">'get请求'</span>)</span><br><span class="line">&#125;);</span><br><span class="line">server.post(<span class="string">'/'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    console.log(<span class="string">'post请求'</span>)</span><br><span class="line">&#125;);</span><br><span class="line">server.use(<span class="string">'/'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    console.log(<span class="string">'use了'</span>)</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure></p>
<h4 id="Express-static"><a href="#Express-static" class="headerlink" title="Express-static"></a>Express-static</h4><p>读取静态文件<br>安装 npm install express-static -save</p>
<p>实例-登录<br>a.html:<br><img src="/2019/08/13/node5/01.png" alt="01.png"><br>server.js<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">const expressStatic = require(<span class="string">'express-static'</span>);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">server.listen(8080);</span><br><span class="line"></span><br><span class="line">//用户数据模拟</span><br><span class="line">var users=&#123;</span><br><span class="line">    <span class="string">'blue'</span>:<span class="string">'123456'</span>,</span><br><span class="line">    <span class="string">'zhangsan'</span>:<span class="string">'654321'</span>,</span><br><span class="line">    <span class="string">'lisi'</span>:<span class="string">'987678'</span></span><br><span class="line">&#125;;</span><br><span class="line">server.get(<span class="string">'/login'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    // urlLib.parse(req.url,<span class="literal">true</span>).query;</span><br><span class="line">    console.log(req.query)</span><br><span class="line">    var user= req.query[<span class="string">'user'</span>];</span><br><span class="line">    var pass= req.query[<span class="string">'pass'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(users[user]==null)&#123;</span><br><span class="line">        res.send(&#123;ok:<span class="literal">false</span>,mag:<span class="string">'此用户不存在'</span>&#125;)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(users[user]!=pass)&#123;</span><br><span class="line">            res.send(&#123;ok:<span class="literal">false</span>,msg:<span class="string">'密码错了'</span>&#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.send(&#123;ok:<span class="literal">true</span>,mag:<span class="string">'成功'</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">server.use(expressStatic(<span class="string">'./www'</span>));</span><br></pre></td></tr></table></figure></p>
<h3 id="数据解析"><a href="#数据解析" class="headerlink" title="数据解析"></a>数据解析</h3><p>get请求数据解析,无需中间件:req.query<br>post请求数据解析，需中间件：body-parser，首先解析数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line">const bodyParser = require(&apos;body-parser&apos;);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">server.listen(8080);</span><br><span class="line"></span><br><span class="line">server.use(bodyParser.urlencoded(&#123;</span><br><span class="line">    extended:true,      //扩展模式</span><br><span class="line">    limit: 2*1024       //限制2M，默认100k</span><br><span class="line">&#125;));</span><br><span class="line">server.use(&apos;/&apos;,function(req,res)&#123;</span><br><span class="line">    console.log(req.body)  //POST</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="链式操作"><a href="#链式操作" class="headerlink" title="链式操作"></a>链式操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">server.listen(8080);</span><br><span class="line"></span><br><span class="line">//第三个参数</span><br><span class="line">server.use(&apos;/&apos;,function(req,res,next)&#123;</span><br><span class="line">    console.log(&apos;a&apos;)</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br><span class="line">server.use(&apos;/&apos;,function(req,res.next)&#123;</span><br><span class="line">    console.log(&apos;b&apos;)  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>中间件,类似’body-parser’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line">const querystring = require(&apos;querystring&apos;);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">server.listen(8080);</span><br><span class="line"></span><br><span class="line">//第三个参数</span><br><span class="line">server.use(function(req,res,next)&#123;</span><br><span class="line">    var str=&apos;&apos;;</span><br><span class="line">    req.on(&apos;data&apos;,function(data)&#123;</span><br><span class="line">        str+=data;</span><br><span class="line">    &#125;);</span><br><span class="line">    req.on(&apos;end&apos;,function(data)&#123;</span><br><span class="line">        req.body=querystring(str);</span><br><span class="line">        next();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">server.use(&apos;/&apos;,function(req,res.next)&#123;</span><br><span class="line">    console.log(&apos;b&apos;)  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="cookie、session"><a href="#cookie、session" class="headerlink" title="cookie、session"></a>cookie、session</h3><ul>
<li>a.发送cookie<br>res.cookie(名字,值,maxAge:毫秒,signed:true)</li>
<li>b.读取cookie<br>cookie-parser<br>server.use(cookieParser(‘秘钥’))<br>server.use(function(){<br>  req.cookie   //未签名<br>  req.signedCookies   //签名版<br>})</li>
<li>c.删除cookie<br>res.clearCookie(名字)</li>
</ul>
<p>保存数据，cookie数据保存浏览器，session 数据保存在服务器。<br>npm install cookie-parser cookie-session<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">const cookieParser = require(<span class="string">'cookie-parser'</span>);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">//发送cookie</span><br><span class="line">server.use(<span class="string">'/aaa/a.html'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    res.cookie(<span class="string">'user'</span>,<span class="string">'blue'</span>,&#123;path:<span class="string">'/aaa'</span>,<span class="string">'maxAge'</span>:3*24*3600*1000&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">//读取cookie</span><br><span class="line">server.use(cookieParser())；</span><br><span class="line">server.use(<span class="string">'/'</span>,<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    console.log(req.cookie)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>实现cookie加密：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">const cookieParser = require(<span class="string">'cookie-parser'</span>);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">//cookieParser</span><br><span class="line">server.use(cookieParser);</span><br><span class="line">server.use(<span class="string">'/'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">    req.secret=<span class="string">'hdwifbonfjfosdjhfsj'</span>;</span><br><span class="line">    res.cookie(<span class="string">'user'</span>,<span class="string">'blue'</span>,&#123;signed:<span class="literal">true</span>&#125;);</span><br><span class="line"></span><br><span class="line">    res.send(<span class="string">'ok'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure></p>
<p>session</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">const cookieSession = require(<span class="string">'cookie-session'</span>);</span><br><span class="line"></span><br><span class="line">var server = express();</span><br><span class="line">//cookie</span><br><span class="line">server.use(cookieParser(<span class="string">'dnkfvbscsvius'</span>));</span><br><span class="line">server.use(cookieSession());</span><br><span class="line"></span><br><span class="line">server.use(<span class="string">'/'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">    req.secret=<span class="string">'hdwifbonfjfosdjhfsj'</span>;</span><br><span class="line">    res.cookie(<span class="string">'user'</span>,<span class="string">'blue'</span>,&#123;signed:<span class="literal">true</span>&#125;);</span><br><span class="line"></span><br><span class="line">    res.send(<span class="string">'ok'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure>
<h3 id="express框架整合"><a href="#express框架整合" class="headerlink" title="express框架整合"></a>express框架整合</h3><p><img src="/2019/08/13/node5/02.png" alt="02.png"><br><img src="/2019/08/13/node5/03.png" alt="03.png"></p>
<h4 id="multer模块上传文件"><a href="#multer模块上传文件" class="headerlink" title="multer模块上传文件"></a>multer模块上传文件</h4><p>npm install multer</p>
<ul>
<li>body-parser:解析post数据  (application/x-form-urlencoded)<br>server.use(bodyParse.urlencode());</li>
<li>multer:解析post文件   (multipart/form-data)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">//上传到磁盘  重命名</span><br><span class="line"></span><br><span class="line">const multer = require(<span class="string">'multer'</span>);</span><br><span class="line">const pathLib = require(<span class="string">'path'</span>);</span><br><span class="line">const fs = require(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//1、pathLib解析获取原始文件扩展名</span><br><span class="line">    var str=<span class="string">'c:\\wamp\www\a.html'</span>;</span><br><span class="line">    var obj=path.parse(str);</span><br><span class="line"></span><br><span class="line">    base :文件名<span class="string">"a.html"</span></span><br><span class="line">    ext:扩展名<span class="string">"html"</span></span><br><span class="line">    dir:路径<span class="string">'c:\\wamp\www'</span></span><br><span class="line">    name:文件名<span class="string">"a"</span></span><br><span class="line"></span><br><span class="line">//2.fs的rename重命名</span><br><span class="line">    fs.rename(<span class="string">'a.txt'</span>,<span class="string">'b.txt'</span>,<span class="keyword">function</span>(err)&#123;</span><br><span class="line">        console.log(err)</span><br><span class="line">    &#125;)</span><br><span class="line">    fs.rename(老名，新名，<span class="keyword">function</span>(err)&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var obj=multer(&#123;dest:<span class="string">'./www/upload/'</span>&#125;)  //文件保存的位置</span><br><span class="line"></span><br><span class="line">server.use(obj.any())       //接受任意类型文件</span><br><span class="line">//只接收name=f1的文件 : server.use(obj.single(<span class="string">'f1'</span>))  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//req.files:指上传的文件信息，如下图：</span><br><span class="line">server.use(<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    var newName = req.file[0].path+pathLib.parse(req.file[0].originalname).ext</span><br><span class="line">    fs.rename(req.file[0].path,newName,<span class="keyword">function</span>()(err)&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)</span><br><span class="line">            res.send(<span class="string">'上传失败'</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res.send(<span class="string">'上传成功'</span>)</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/08/13/node5/05.png" alt="05.png"><br><img src="/2019/08/13/node5/06.png" alt="06.png"></p>
<ul>
<li>html文件：</li>
</ul>
<p><img src="/2019/08/13/node5/04.png" alt="04.png"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">'http://localhost:8080/'</span> method=<span class="string">'post'</span> enctype=<span class="string">'multipart/form-data'</span>&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">'file'</span>/&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">'submit'</span> value=<span class="string">'上传/&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="consolidate-模板引擎整合库"><a href="#consolidate-模板引擎整合库" class="headerlink" title="consolidate 模板引擎整合库"></a>consolidate 模板引擎整合库</h3><p>安装：npm install consolidate<br>引用：const consolidate = require(‘consolidate’);<br>配置模板引擎：</p>
<ul>
<li>我要输出什么东西<br>server.set(‘view engine’,’html’)</li>
<li>模板文件放在哪里<br>server.set(‘view’,’./views’)</li>
<li>哪种模板引擎<br>server.engine(‘html’,consolidate.ejs)</li>
</ul>
<p>server.get(‘/‘,function(req,res){<br>    res.render(‘模板文件’，数据);<br>})</p>
<h3 id="route路由"><a href="#route路由" class="headerlink" title="route路由"></a>route路由</h3><p>根据目录的不同，调用不同的模块</p>
<p>const express = require(‘express’);</p>
<p>var server=express();</p>
<p>var routeUser =express.Route();<br>routeUser.get(‘1.html’,function(req,res){<br>    res.send(‘user1’)<br>})<br>routeUser.get(‘2.html’,function(req,res){<br>    res.send(‘user2’)<br>})</p>
<p>server.use(‘/user’,routeUser);<br>server.listen(8080);</p>

                
                <div class="readmore">
                    <a href="/2019/08/13/node5/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/11/node4/">
                        node笔记(一)
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-11T11:48:05.000Z">
                            2019-08-11
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Node/">Node</a></li></ul>
                </div>
                
                    <h3 id="node"><a href="#node" class="headerlink" title="node"></a>node</h3><p>优势：<br>1、性能好<br>2、跟前台JS配合方便<br>3、NodeJS便于前端学习</p>
<h3 id="http系统模块使用"><a href="#http系统模块使用" class="headerlink" title="http系统模块使用"></a>http系统模块使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const http=require(<span class="string">'http'</span>);</span><br><span class="line">var server = http.creatServer(<span class="keyword">function</span>(req,res)&#123;  //创建服务器</span><br><span class="line">    switch(res.url)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"/1.html"</span>:</span><br><span class="line">            res.write(<span class="string">"向前台写东西111"</span>)；</span><br><span class="line">            <span class="built_in">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="string">"/2.html"</span>:</span><br><span class="line">            res.write(<span class="string">"向前台写东西222"</span>)；</span><br><span class="line">            <span class="built_in">break</span>;</span><br><span class="line">        default</span><br><span class="line">            res.write(<span class="string">"404"</span>)；</span><br><span class="line">            <span class="built_in">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    // res.write(<span class="string">"向前台写东西"</span>)；</span><br><span class="line">    res.end();//结束请求</span><br><span class="line">&#125;)</span><br><span class="line">//监听 —— 等着</span><br><span class="line">//端口 —— 数字</span><br><span class="line">server.listen(8888);</span><br></pre></td></tr></table></figure>
<h3 id="fs文件模块"><a href="#fs文件模块" class="headerlink" title="fs文件模块"></a>fs文件模块</h3><p>fs (file system)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//导入引用:</span><br><span class="line">    const fs = require(<span class="string">'fs'</span>);</span><br><span class="line">//1.readFile(文件名，回调函数)</span><br><span class="line">    fs.readFile(<span class="string">'aaa.txt'</span>,<span class="keyword">function</span>(err,data)&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            console.log(<span class="string">'读取失败'</span>)；</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            console.log(data.toString());//二进制格式用toString转换</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">//2.writeFile(文件名，内容，回调函数)</span><br><span class="line">fs.write(<span class="string">"bbb.txt"</span>,<span class="string">"asdfghjkl"</span>,<span class="keyword">function</span>(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>与服务器结合<br>建立www（可以是其他名字）文件夹，用于存放请求的文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const http=require(<span class="string">'http'</span>);</span><br><span class="line">var server = http.creatServer(<span class="keyword">function</span>(req,res)&#123;  //创建服务器</span><br><span class="line">    //req.url = <span class="string">'index.html'</span></span><br><span class="line">    //读取:<span class="string">'./www/index.html'</span></span><br><span class="line">    var file_name = <span class="string">'./www'</span>+req.url</span><br><span class="line">    </span><br><span class="line">    fs.readFile(file_name,<span class="keyword">function</span>(err,data)&#123; //异步</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            res.write(<span class="string">'读取失败'</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.write(data)</span><br><span class="line">        &#125;</span><br><span class="line">        res.end();//结束请求，因为异步，res.end()应放在此处</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line">server.listen(8888);</span><br></pre></td></tr></table></figure></p>
<h3 id="http数据解析（get）"><a href="#http数据解析（get）" class="headerlink" title="http数据解析（get）"></a>http数据解析（get）</h3><p>前台发送请求的方式：form/ajax/jsonp<br>后台都是一样。唯有一点不同，请求方式不同，接受方式不一样（get/post）.下面一个实例：<br>GET数据解析：</p>
<ul>
<li>自己切</li>
<li>querystring:</li>
<li>url:urlLib.parse(…,true)</li>
</ul>
<p>server.js 普通写法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const http = require(<span class="string">'http'</span>);</span><br><span class="line">http.createServer(<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">    //req获取前台请求的数据</span><br><span class="line">    var get=&#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span>(req.url.indexOf(<span class="string">'?'</span>) != -1)&#123;</span><br><span class="line">        console.log(req.url); //  /aaa?user=Tom&amp;pass=123456</span><br><span class="line">        var arr = req.url.split(<span class="string">'？'</span>)；// arr[0]=<span class="string">'/aaa'</span>  arr[1]=<span class="string">'user=Tom&amp;pass=123456'</span></span><br><span class="line">        var url=arr[0];</span><br><span class="line">        var arr2 = arr[1].split(<span class="string">'&amp;'</span>); //arr2</span><br><span class="line">        <span class="keyword">for</span>(var i=0;i&lt;arr2.length;i++)&#123;</span><br><span class="line">            var arr3=arr2[i].split(<span class="string">'='</span>)</span><br><span class="line">            get[arr3[0]]=arr3[1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        var url=req.url;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(url,get)</span><br><span class="line">    res.end();</span><br><span class="line">&#125;).listen(8080);</span><br></pre></td></tr></table></figure></p>
<p>server.js querystring模块写法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  //写法如下：</span><br><span class="line">    //const querystring=require(<span class="string">'querystring'</span>);</span><br><span class="line">    //var json = querystring.parse(<span class="string">'user=Tom&amp;pass=123456'</span>)</span><br><span class="line">    //console.log(json)</span><br><span class="line">//server.js改动后：</span><br><span class="line">    const http = require(<span class="string">'http'</span>);</span><br><span class="line">    const querystring=require(<span class="string">'querystring'</span>);</span><br><span class="line">    http.createServer(<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">        //req获取前台请求的数据</span><br><span class="line">        var get=&#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span>(req.url.indexOf(<span class="string">'?'</span>) != -1)&#123;</span><br><span class="line">            console.log(req.url); //  /aaa?user=Tom&amp;pass=123456</span><br><span class="line">            var arr = req.url.split(<span class="string">'？'</span>)；// arr[0]=<span class="string">'/aaa'</span>  arr[1]=<span class="string">'user=Tom&amp;pass=123456'</span></span><br><span class="line">            var url=arr[0];</span><br><span class="line">            get=querystring.parse(arr[1]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            var url=req.url;</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(url,get)</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;).listen(8080);</span><br></pre></td></tr></table></figure></p>
<p>server.js url模块写法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//url.js写法</span><br><span class="line">    const urlLib=require(<span class="string">'url'</span>);</span><br><span class="line">    var obj= urlLib.parse(<span class="string">"http://www.aaa.bbb/index.html?a=12&amp;b=55"</span>,<span class="literal">true</span>);  第二个参数为<span class="literal">true</span>时，会把pathname等解析为json.</span><br><span class="line">    console.log(obj.pathname,obj.query);</span><br><span class="line">//server.js改动后：</span><br><span class="line">    const http = require(<span class="string">'http'</span>);</span><br><span class="line">    http.createServer(<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">        //req获取前台请求的数据</span><br><span class="line">        var obj = urlLib.parse(req.url,<span class="literal">true</span>);</span><br><span class="line">        var url=obj.pathname;</span><br><span class="line">        var get=obj.query;</span><br><span class="line"></span><br><span class="line">        console.log(url,get)</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;).listen(8080);</span><br></pre></td></tr></table></figure></p>
<p>form.html<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">"http://localhost:8080/aaa"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">        用户：</span><br><span class="line">        &lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"user"</span> value=<span class="string">''</span>&gt; &lt;br&gt;</span><br><span class="line">        &lt;input <span class="built_in">type</span>=<span class="string">"password"</span> name=<span class="string">"pass"</span> value=<span class="string">''</span>&gt; &lt;br&gt;</span><br><span class="line">        &lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">'提交'</span></span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="http数据解析（post）"><a href="#http数据解析（post）" class="headerlink" title="http数据解析（post）"></a>http数据解析（post）</h3><p>POST数据接收：POST数据比GET数据大的多,根据数据量大小分段完成<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const http=require(<span class="string">'http'</span>);</span><br><span class="line">const querystring=require(<span class="string">'querystring'</span>);</span><br><span class="line">http.creatServer(<span class="keyword">function</span>(req,res)&#123;</span><br><span class="line">        //POST--req</span><br><span class="line">    var str=<span class="string">''</span>;  //接受数据</span><br><span class="line"></span><br><span class="line">        //data--有一段数据到达（很多次）</span><br><span class="line">    req.on(<span class="string">'data'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        str+=data</span><br><span class="line">    &#125;);</span><br><span class="line">        //end--数据全部到达（一次）</span><br><span class="line">    req.on(<span class="string">'end'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        var post = querystring.parse(str);</span><br><span class="line">        console.log(post)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;).listen(8080);</span><br></pre></td></tr></table></figure></p>
<h3 id="应用1-简易httpServer搭建-用户注册登录-略"><a href="#应用1-简易httpServer搭建-用户注册登录-略" class="headerlink" title="应用1:简易httpServer搭建,用户注册登录(略)"></a>应用1:简易httpServer搭建,用户注册登录(略)</h3><h3 id="nodeJS模块化"><a href="#nodeJS模块化" class="headerlink" title="nodeJS模块化"></a>nodeJS模块化</h3><h4 id="系统模块介绍"><a href="#系统模块介绍" class="headerlink" title="系统模块介绍"></a>系统模块介绍</h4><p>除了以上用到的：http、querystring、url,还有：</p>
<ul>
<li>Crypto 加密</li>
<li>Event 事件</li>
<li>Net 网络操作</li>
<li>OS 操作系统信息</li>
<li>Path 处理文件路径</li>
<li>Stream 流操作</li>
<li>Timer 定时器</li>
<li>ZLIB 压缩</li>
</ul>
<h4 id="自定义模块"><a href="#自定义模块" class="headerlink" title="自定义模块"></a>自定义模块</h4><p>关于引入模块写法：若为当前目录自己的模块，加上“./”,系统模块要加。<br>若想要输出东西，必须exports。<br>若都输出多个东西，module可实现批量输出。</p>
<ul>
<li>require:请求引入其他模块。</li>
<li>module:批量输出。</li>
<li>exports:输出。</li>
<li>module.exports == exports。</li>
<li>const aaa = require(‘./bbb.js’); 其中“.js”可省略。</li>
</ul>
<p>npm:nodejs package manager(nodejs包管理器)<br>1、统计下载途径<br>2、自动下载依赖</p>
<p>npm init<br>npm publish<br>npm update<br>npm unpublish<br>npm –force unpublish</p>
<p><img src="/2019/08/11/node4/01.png" alt="01.png"></p>
<p>node_modules:放模块，可以放自己定义的模块，此时若引用，不加“./”</p>
<blockquote>
<p>总结：require引入模块，若有“./”,从当前目录找，若没有“./”，从系统模块或node_modules找。<br>模块优先级：系统&gt;node_modules,一般将自定义模块放在node_modules中。</p>
</blockquote>

                
                <div class="readmore">
                    <a href="/2019/08/11/node4/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/11/apply-and-bind/">
                        apply and bind
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-11T02:36:27.000Z">
                            2019-08-11
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/基础前端技术/">基础前端技术</a></li></ul>
                </div>
                
                    <p>本篇主要解决一下几个问题：</p>
<ul>
<li>1.apply和call的区别在哪里</li>
<li>2.什么情况下用apply,什么情况下用call</li>
<li>3.apply的其他巧妙用法（一般在什么情况下可以使用apply）*</li>
</ul>
<p><font color="red"> apply:方法能劫持另外一个对象的方法，继承另外一个对象的属性.</font></p>
<blockquote>
<p>Function.apply(obj,args)方法能接收两个参数<br>obj：这个对象将代替Function类里this对象<br>args：这个是数组，它将作为参数传给Function（args–&gt;arguments）</p>
</blockquote>
<p>call:和apply的意思一样,只不过是参数列表不一样.</p>
<blockquote>
<p>Function.call(obj,[param1[,param2[,…[,paramN]]]])<br>obj：这个对象将代替Function类里this对象<br>params：这个是一个参数列表</p>
</blockquote>
<h4 id="apply示例"><a href="#apply示例" class="headerlink" title="apply示例:"></a>apply示例:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">    /*定义一个人类*/</span><br><span class="line">    <span class="keyword">function</span> Person(name,age)</span><br><span class="line">    &#123;</span><br><span class="line">        this.name=name;</span><br><span class="line">        this.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    /*定义一个学生类*/</span><br><span class="line">    functionStudent(name,age,grade)</span><br><span class="line">    &#123;</span><br><span class="line">        Person.apply(this,arguments);</span><br><span class="line">        this.grade=grade;</span><br><span class="line">    &#125;</span><br><span class="line">    //创建一个学生类</span><br><span class="line">    var student=new Student(<span class="string">"qian"</span>,21,<span class="string">"一年级"</span>);</span><br><span class="line">    //测试</span><br><span class="line">    alert(<span class="string">"name:"</span>+student.name+<span class="string">"\n"</span>+<span class="string">"age:"</span>+student.age+<span class="string">"\n"</span>+<span class="string">"grade:"</span>+student.grade);</span><br><span class="line">    //大家可以看到测试结果name:qian  age:21  grade:一年级</span><br><span class="line">    //学生类里面我没有给name和age属性赋值啊,为什么又存在这两个属性的值呢,这个就是apply的神奇之处.</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>分析: Person.apply(this,arguments);</p>
<ul>
<li>this:在创建对象在这个时候代表的是student</li>
<li>arguments:是一个数组,也就是[“qian”,”21”,”一年级”];<br>也就是通俗一点讲就是:用student去执行Person这个类里面的内容,在Person这个类里面存在this.name等之类的语句,这样就将属性创建到了student对象里面</li>
</ul>
<h4 id="call示例"><a href="#call示例" class="headerlink" title="call示例"></a>call示例</h4><p>在Studen函数里面可以将apply中修改成如下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person.call(this,name,age);</span><br></pre></td></tr></table></figure></p>
<h4 id="什么情况下用apply-什么情况下用call"><a href="#什么情况下用apply-什么情况下用call" class="headerlink" title="什么情况下用apply,什么情况下用call"></a>什么情况下用apply,什么情况下用call</h4><p>在给对象参数的情况下,如果参数的形式是数组的时候,比如apply示例里面传递了参数arguments,这个参数是数组类型,并且在调用Person的时候参数的列表是对应一致的(也就是Person和Student的参数列表前两位是一致的) 就可以采用 apply , 如果我的Person的参数列表是这样的(age,name),而Student的参数列表是(name,age,grade),这样就可以用call来实现了,也就是直接指定参数列表对应值的位置(Person.call(this,age,name,grade));</p>
<h4 id="apply的一些其他巧妙用法"><a href="#apply的一些其他巧妙用法" class="headerlink" title="apply的一些其他巧妙用法"></a>apply的一些其他巧妙用法</h4><p>细心的人可能已经察觉到,在我调用apply方法的时候,第一个参数是对象(this), 第二个参数是一个数组集合, 在调用Person的时候,他需要的不是一个数组,但是为什么他给我一个数组我仍然可以将数组解析为一个一个的参数,这个就是apply的一个巧妙的用处,可以将一个数组默认的转换为一个参数列表([param1,param2,param3] 转换为 param1,param2,param3) 这个如果让我们用程序来实现将数组的每一个项,来装换为参数的列表,可能都得费一会功夫,借助apply的这点特性,所以就有了以下高效率的方法:</p>
<p>a) Math.max 可以实现得到数组中最大的一项</p>
<p>因为Math.max参数里面不支持Math.max([param1,param2])也就是数组但是它支持Math.max(param1,param2,param3…),所以可以根据刚才apply的那个特点来解决 var max=Math.max.apply(null,array),这样轻易的可以得到一个数组中最大的一项(apply会将一个数组装换为一个参数接一个参数的传递给方法)<br>这块在调用的时候第一个参数给了一个null,这个是因为没有对象去调用这个方法,我只需要用这个方法帮我运算,得到返回的结果就行,.所以直接传递了一个null过去</p>
<p>b) Math.min  可以实现得到数组中最小的一项同样和 max是一个思想 var min=Math.min.apply(null,array);</p>
<p>c) Array.prototype.push 可以实现两个数组合并</p>
<p>同样push方法没有提供push一个数组,但是它提供了push(param1,param,…paramN) 所以同样也可以通过apply来装换一下这个数组,即:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vararr1=new Array(<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>);</span><br><span class="line">vararr2=new Array(<span class="string">"4"</span>,<span class="string">"5"</span>,<span class="string">"6"</span>);</span><br><span class="line">Array.prototype.push.apply(arr1,arr2);</span><br></pre></td></tr></table></figure></p>

                
                <div class="readmore">
                    <a href="/2019/08/11/apply-and-bind/">
                        阅读更多
                    </a>
                </div>
            </div>
        
    </div>


    <div id="content-aside">
    <div class="content-aside-owner">
        <div id="owner">
    <div class="avatar-bg">
        <div class="index-page">
            <div class="banner">
                <div class="slide slide1">
                    <div class="bg-wrapper">
                        <div class="bg" id="container_left">
                            <div id="canvas_left"></div>
                        </div>
                    </div>
                </div>
                <div class="slide slide2">
                    <div class="bg-wrapper">
                        <div class="bg" id="container_right">
                            <div id="canvas_right"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a href="/"><img class="avatar" src="/images/avatar.jpg" alt=""></a>
    <a href="/"><h3 class="author">I&#39;m xiedandan</h3></a>
    <h4>^_^</h4>
    <div class="social">
        
            
              <a href="https://github.com/xdd7130" title="github" class="fa fa-github" target="_blank"></a>
            
        
            
              <a href="#" title="weibo" class="fa fa-weibo" target="_blank"></a>
            
        
    </div>
</div>
    </div>
    
        <div class="content-aside-about">
            <h2>
                <a href="/about">关于</a>
            </h2>
        </div>
    
    <div class="content-aside-tags">
        <h2>
            <a href="/tags">
                标签
                <sup style="font-size: 12px">
                    [25]
                </sup>
            </a>
        </h2>
    </div>
    
<aside id="categories">
    <h2>分类</h2>
    
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node/">Node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VUE/">VUE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他前端技术/">其他前端技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/基础前端技术/">基础前端技术</a></li></ul>
    
</aside>

    
<aside id="acchives">
    <h2>归档</h2>
    
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li></ul>
    
</aside>

</div>

</div>
<nav id="pagination" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
</nav>

    </div>
</div>
<footer id="footer">
     <div id="copyright">&copy; I&#39;m xiedandan  2020</div>
     
             <!-- 不蒜子统计 -->
             <span id="busuanzi_container_site_pv">
                     本站总访问量<span id="busuanzi_value_site_pv" style='color:#17a167'></span>次
             </span>
             <span class="post-meta-divider">|</span>
             <span id="busuanzi_container_site_uv">
                     本站访客数<span id="busuanzi_value_site_uv"  style='color:#17a167'></span>人
             </span>
             <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
       
    <div id="theme">
        Powered by <a href="http://hexo.io">Hexo</a>. Theme by <a href="https://github.com/markyong/hexo-theme-stage">Stage</a>
    </div>
</footer>
<script src="/lib/js/waterrippleeffect.min.js"></script>
<script src="/js/header-bg.main.js"></script>

    <script src="/lib/js/cav.js"></script>
    <script src="/js/avatar-bg.main.js"></script>

</body>
</html>
