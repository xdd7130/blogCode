
<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <title>DD_XIE的学习笔记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="">
    <meta name="description" content="前端学习">
    
        <link rel="icon" href="/favicon.ico">
    
    
        
            <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
        
            <link rel="stylesheet" href="/css/stage.css">
        
            <link rel="stylesheet" href="/css/avatar-bg.css">
        
    
</head>
</html>
<body>
<header id="header">
    <div class="menu">
        <i class="fa fa-bars"></i>
    </div>
    <div class="header-main">
        <h1><a href="/">DD_XIE的学习笔记</a></h1>
    </div>
    <div id="nav">
        <div class="nav-img" id="nav-img"></div>
        <div class="sentences">
            时光荏苒，旦夕之间，略有遗憾，似白驹过隙，蹉跎自悟。
        </div>
    </div>
</header>

<div id="content-outer">
    <div id="content-inner">
        <div class="clearfix">
    
    <div id="recent-posts">
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/07/python基础2/">
                        python基础(二)--语句
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-07T10:24:58.000Z">
                            2019-08-07
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/python/">python</a></li></ul>
                </div>
                
                    <h3 id="Python-条件语句"><a href="#Python-条件语句" class="headerlink" title="Python 条件语句"></a>Python 条件语句</h3><p>Python条件语句是通过一条或多条语句的执行结果（True或者False）来决定执行的代码块。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if 判断条件：</span><br><span class="line">    执行语句……</span><br><span class="line">else：</span><br><span class="line">    执行语句……</span><br></pre></td></tr></table></figure></p>
<p><img src="/2019/08/07/python基础2/01.gif" alt="01.gif"><br>if 语句的判断条件可以用&gt;（大于）、&lt;(小于)、==（等于）、&gt;=（大于等于）、&lt;=（小于等于）来表示其关系。</p>
<p>当判断条件为多个值时，可以使用以下形式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if 判断条件1:</span><br><span class="line">    执行语句1……</span><br><span class="line">elif 判断条件2:</span><br><span class="line">    执行语句2……</span><br><span class="line">elif 判断条件3:</span><br><span class="line">    执行语句3……</span><br><span class="line">else:</span><br><span class="line">    执行语句4……</span><br></pre></td></tr></table></figure></p>
<p>简单的语句组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python </span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">var = 100 </span><br><span class="line">if ( var  == 100 ) : print &quot;变量 var 的值为100&quot; </span><br><span class="line">print &quot;Good bye!&quot;</span><br></pre></td></tr></table></figure></p>
<h3 id="Python-循环语句"><a href="#Python-循环语句" class="headerlink" title="Python 循环语句"></a>Python 循环语句</h3><p><img src="/2019/08/07/python基础2/01.png" alt="01.png"><br>循环控制语句<br><img src="/2019/08/07/python基础2/02.png" alt="02.png"></p>
<h4 id="Python-While-循环语句"><a href="#Python-While-循环语句" class="headerlink" title="Python While 循环语句"></a>Python While 循环语句</h4><p>Python 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。其基本形式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">while 判断条件：</span><br><span class="line">    执行语句……</span><br></pre></td></tr></table></figure></p>
<p><img src="/2019/08/07/python基础2/02.gif" alt="02.gif"><br>while 语句时还有另外两个重要的命令 continue，break 来跳过循环，continue 用于跳过该次循环，break .</p>
<p>循环使用 else 语句<br>在 python 中，while … else 在循环条件为 false 时执行 else 语句块：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"> </span><br><span class="line">count = 0</span><br><span class="line">while count &lt; 5:</span><br><span class="line">   print count, &quot; is  less than 5&quot;</span><br><span class="line">   count = count + 1</span><br><span class="line">else:</span><br><span class="line">   print count, &quot; is not less than 5&quot;</span><br></pre></td></tr></table></figure></p>
<p>简单语句组<br>类似 if 语句的语法，如果你的 while循环体中只有一条语句，你可以将该语句与while写在同一行中， 如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">flag = 1</span><br><span class="line">while (flag): print &apos;Given flag is really true!&apos;</span><br><span class="line">print &quot;Good bye!&quot;</span><br></pre></td></tr></table></figure></p>
<h4 id="Python-for-循环语句"><a href="#Python-for-循环语句" class="headerlink" title="Python for 循环语句"></a>Python for 循环语句</h4><p>Python for循环可以遍历任何序列的项目，如一个列表或者一个字符串。</p>
<p>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for iterating_var in sequence:</span><br><span class="line">   statements(s)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">for letter in &apos;Python&apos;:     # 第一个实例</span><br><span class="line">   print &apos;当前字母 :&apos;, letter</span><br><span class="line"> </span><br><span class="line">fruits = [&apos;banana&apos;, &apos;apple&apos;,  &apos;mango&apos;]</span><br><span class="line">for fruit in fruits:        # 第二个实例</span><br><span class="line">   print &apos;当前水果 :&apos;, fruit</span><br><span class="line"> </span><br><span class="line">print &quot;Good bye!&quot;</span><br></pre></td></tr></table></figure>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前字母 : P</span><br><span class="line">当前字母 : y</span><br><span class="line">当前字母 : t</span><br><span class="line">当前字母 : h</span><br><span class="line">当前字母 : o</span><br><span class="line">当前字母 : n</span><br><span class="line">当前水果 : banana</span><br><span class="line">当前水果 : apple</span><br><span class="line">当前水果 : mango</span><br><span class="line">Good bye!</span><br></pre></td></tr></table></figure></p>
<p>通过序列索引迭代:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">fruits = [&apos;banana&apos;, &apos;apple&apos;,  &apos;mango&apos;]</span><br><span class="line">for index in range(len(fruits)):</span><br><span class="line">   print &apos;当前水果 :&apos;, fruits[index]</span><br><span class="line"> </span><br><span class="line">print &quot;Good bye!&quot;</span><br></pre></td></tr></table></figure></p>
<p>循环使用 else 语句<br>在 python 中，for … else 表示这样的意思，for 中的语句和普通的没有区别，else 中的语句会在循环正常执行完（即 for 不是通过 break 跳出而中断的）的情况下执行，while … else 也是一样。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for num in range(10,20):  # 迭代 10 到 20 之间的数字</span><br><span class="line">   for i in range(2,num): # 根据因子迭代</span><br><span class="line">      if num%i == 0:      # 确定第一个因子</span><br><span class="line">         j=num/i          # 计算第二个因子</span><br><span class="line">         print &apos;%d 等于 %d * %d&apos; % (num,i,j)</span><br><span class="line">         break            # 跳出当前循环</span><br><span class="line">   else:                  # 循环的 else 部分</span><br><span class="line">      print num, &apos;是一个质数&apos;</span><br></pre></td></tr></table></figure></p>
<h4 id="Python-循环嵌套"><a href="#Python-循环嵌套" class="headerlink" title="Python 循环嵌套"></a>Python 循环嵌套</h4><p>Python 语言允许在一个循环体里面嵌入另一个循环。</p>
<p>Python for 循环嵌套语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for iterating_var in sequence:</span><br><span class="line">   for iterating_var in sequence:</span><br><span class="line">      statements(s)</span><br><span class="line">   statements(s)</span><br><span class="line">Python while 循环嵌套语法：</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while expression:</span><br><span class="line">   while expression:</span><br><span class="line">      statement(s)</span><br><span class="line">   statement(s)</span><br></pre></td></tr></table></figure>
<p>你可以在循环体内嵌入其他的循环体，如在while循环中可以嵌入for循环， 反之，你可以在for循环中嵌入while循环</p>
<h4 id="Python-break-语句"><a href="#Python-break-语句" class="headerlink" title="Python break 语句"></a>Python break 语句</h4><p>Python break语句，就像在C语言中，打破了最小封闭for或while循环。</p>
<p>break语句用来终止循环语句，即循环条件没有False条件或者序列还没被完全递归完，也会停止执行循环语句。</p>
<p>break语句用在while和for循环中。</p>
<p>如果您使用嵌套循环，break语句将停止执行最深层的循环，并开始执行下一行代码。</p>
<h4 id="Python-continue-语句"><a href="#Python-continue-语句" class="headerlink" title="Python continue 语句"></a>Python continue 语句</h4><p>Python continue 语句跳出本次循环，而break跳出整个循环。</p>
<p>continue 语句用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。</p>
<p>continue语句用在while和for循环中。</p>
<h4 id="Python-pass-语句"><a href="#Python-pass-语句" class="headerlink" title="Python pass 语句"></a>Python pass 语句</h4><p>Python pass 是空语句，是为了保持程序结构的完整性。</p>
<p>pass 不做任何事情，一般用做占位语句。</p>

                
                <div class="readmore">
                    <a href="/2019/08/07/python基础2/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/07/python基础1/">
                        python基础（一）
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-07T02:27:58.000Z">
                            2019-08-07
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/python/">python</a></li></ul>
                </div>
                
                    <h3 id="Python-中文编码"><a href="#Python-中文编码" class="headerlink" title="Python 中文编码"></a>Python 中文编码</h3><p>Python中默认的编码格式是 ASCII 格式，在没修改编码格式时无法正确打印汉字，所以在读取中文时会报错。</p>
<p>解决方法为只要在文件开头加入 # -<em>- coding: UTF-8 -</em>- 或者 # coding=utf-8 就行了</p>
<h3 id="Python-基础语法"><a href="#Python-基础语法" class="headerlink" title="Python 基础语法"></a>Python 基础语法</h3><h4 id="Python-标识符"><a href="#Python-标识符" class="headerlink" title="Python 标识符"></a>Python 标识符</h4><ul>
<li>在 Python 里，标识符由字母、数字、下划线组成。</li>
<li>在 Python 中，所有标识符可以包括英文、数字以及下划线(_)，但不能以数字开头。</li>
<li>Python 中的标识符是区分大小写的。</li>
<li>以下划线开头的标识符是有特殊意义的。以单下划线开头 _foo 的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用 from xxx import * 而导入。</li>
<li><p>以双下划线开头的 <strong>foo 代表类的私有成员，以双下划线开头和结尾的 </strong>foo__ 代表 Python 里特殊方法专用的标识，如 <strong>init</strong>() 代表类的构造函数。</p>
</li>
<li><p>Python 可以同一行显示多条语句，方法是用分号 ; 分开，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print &apos;hello&apos;;print &apos;runoob&apos;;</span><br><span class="line">hello</span><br><span class="line">runoob</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Python-保留字符"><a href="#Python-保留字符" class="headerlink" title="Python 保留字符"></a>Python 保留字符</h4><table>
<thead>
<tr>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">and</td>
<td style="text-align:center">exec</td>
<td style="text-align:center">not</td>
</tr>
<tr>
<td style="text-align:center">assert</td>
<td style="text-align:center">finally</td>
<td style="text-align:center">or</td>
</tr>
<tr>
<td style="text-align:center">break</td>
<td style="text-align:center">for pass</td>
</tr>
<tr>
<td style="text-align:center">class</td>
<td style="text-align:center">from</td>
<td style="text-align:center">print</td>
</tr>
<tr>
<td style="text-align:center">continue</td>
<td style="text-align:center">global</td>
<td style="text-align:center">raise</td>
</tr>
<tr>
<td style="text-align:center">def</td>
<td style="text-align:center">if</td>
<td style="text-align:center">return</td>
</tr>
<tr>
<td style="text-align:center">del</td>
<td style="text-align:center">import</td>
<td style="text-align:center">try</td>
</tr>
<tr>
<td style="text-align:center">elif</td>
<td style="text-align:center">in</td>
<td style="text-align:center">while</td>
</tr>
<tr>
<td style="text-align:center">else</td>
<td style="text-align:center">is</td>
<td style="text-align:center">with</td>
</tr>
<tr>
<td style="text-align:center">except</td>
<td style="text-align:center">lambda</td>
<td style="text-align:center">yield</td>
</tr>
</tbody>
</table>
<h4 id="行和缩进"><a href="#行和缩进" class="headerlink" title="行和缩进"></a>行和缩进</h4><p>Python 与其他语言最大的区别就是，Python的代码块不使用大括号{}来控制类，函数以及其他逻辑判断。python 最具特色的就是用缩进来写模块。</p>
<p><font color="red">缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。</font>如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"># 文件名：test.py</span><br><span class="line"></span><br><span class="line">if True:</span><br><span class="line">    print &quot;Answer&quot;</span><br><span class="line">    print &quot;True&quot;</span><br><span class="line">else:</span><br><span class="line">    print &quot;Answer&quot;</span><br><span class="line">    # 没有严格缩进，在执行时会报错</span><br><span class="line">  print &quot;False&quot;</span><br></pre></td></tr></table></figure></p>
<p>执行以上代码，会出现如下错误提醒：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python test.py  </span><br><span class="line">  File &quot;test.py&quot;, line 10</span><br><span class="line">    print &quot;False&quot;</span><br><span class="line">                ^</span><br><span class="line">IndentationError: unindent does not match any outer indentation level</span><br></pre></td></tr></table></figure></p>
<p>IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。</p>
<p>如果是 IndentationError: unexpected indent 错误, 则 python 编译器是在告诉你”Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题”，所有 python 对格式要求非常严格。</p>
<p>因此，在 Python 的代码块中必须使用相同数目的行首缩进空格数。</p>
<p>建议你在每个缩进层次使用 单个制表符 或 两个空格 或 四个空格 , 切记不能混用</p>
<h4 id="多行语句"><a href="#多行语句" class="headerlink" title="多行语句"></a>多行语句</h4><p>Python语句中一般以新行作为语句的结束符。</p>
<p>但是我们可以使用斜杠（ \）将一行的语句分为多行显示，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">total = item_one + \</span><br><span class="line">        item_two + \</span><br><span class="line">        item_three</span><br></pre></td></tr></table></figure></p>
<p>语句中包含 [], {} 或 () 括号就不需要使用多行连接符。如下实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">days = [&apos;Monday&apos;, &apos;Tuesday&apos;, &apos;Wednesday&apos;,</span><br><span class="line">        &apos;Thursday&apos;, &apos;Friday&apos;]</span><br></pre></td></tr></table></figure></p>
<h4 id="Python-引号"><a href="#Python-引号" class="headerlink" title="Python 引号"></a>Python 引号</h4><p>Python 可以使用引号( ‘ )、双引号( “ )、三引号( ‘’’ 或 “”” ) 来表示字符串，引号的开始与结束必须的相同类型的。</p>
<p>其中三引号可以由多行组成，编写多行文本的快捷语法，常用于文档字符串，在文件的特定地点，被当做注释。</p>
<h4 id="Python注释"><a href="#Python注释" class="headerlink" title="Python注释"></a>Python注释</h4><p>python中单行注释采用 # 开头。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"># 文件名：test.py</span><br><span class="line"></span><br><span class="line"># 第一个注释</span><br><span class="line">print &quot;Hello, Python!&quot;  # 第二个注释</span><br></pre></td></tr></table></figure></p>
<p>python 中多行注释使用三个单引号(‘’’)或三个双引号(“””)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"># 文件名：test.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">这是多行注释，使用单引号。</span><br><span class="line">这是多行注释，使用单引号。</span><br><span class="line">这是多行注释，使用单引号。</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">这是多行注释，使用双引号。</span><br><span class="line">这是多行注释，使用双引号。</span><br><span class="line">这是多行注释，使用双引号。</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></p>
<p>####Python空行<br>函数之间或类的方法之间用空行分隔，表示一段新的代码的开始。类和函数入口之间也用一行空行分隔，以突出函数入口的开始。</p>
<p>空行与代码缩进不同，空行并不是Python语法的一部分。书写时不插入空行，Python解释器运行也不会出错。但是空行的作用在于分隔两段不同功能或含义的代码，便于日后代码的维护或重构。</p>
<p>记住：空行也是程序代码的一部分</p>
<h4 id="等待用户输入"><a href="#等待用户输入" class="headerlink" title="等待用户输入"></a>等待用户输入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"># \n 实现换行。一旦用户按下 enter(回车) 键退出，其它键显示。</span><br><span class="line">input(&quot;按下 enter 键退出，其他任意键显示...\n&quot;)   # python2 raw_input()</span><br></pre></td></tr></table></figure>
<h4 id="同一行显示多条语句"><a href="#同一行显示多条语句" class="headerlink" title="同一行显示多条语句"></a>同一行显示多条语句</h4><p>Python可以在同一行中使用多条语句，语句之间使用分号(;)分割，以下是一个简单的实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import sys; x = &apos;runoob&apos;; sys.stdout.write(x + &apos;\n&apos;)</span><br></pre></td></tr></table></figure></p>
<h4 id="Print-输出"><a href="#Print-输出" class="headerlink" title="Print 输出"></a>Print 输出</h4><p>print 默认输出是换行的，如果要实现不换行需要在变量末尾加上逗号 ,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line">x=&quot;a&quot;</span><br><span class="line">y=&quot;b&quot;</span><br><span class="line"># 换行输出</span><br><span class="line">print x</span><br><span class="line">print y</span><br><span class="line"></span><br><span class="line">print &apos;---------&apos;</span><br><span class="line"># 不换行输出</span><br><span class="line">print x,</span><br><span class="line">print y,</span><br><span class="line"></span><br><span class="line"># 不换行输出</span><br><span class="line">print x,y</span><br></pre></td></tr></table></figure></p>
<p>以上实例执行结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a</span><br><span class="line">b</span><br><span class="line">---------</span><br><span class="line">a b a b</span><br></pre></td></tr></table></figure></p>
<h4 id="多个语句构成代码组"><a href="#多个语句构成代码组" class="headerlink" title="多个语句构成代码组"></a>多个语句构成代码组</h4><p>缩进相同的一组语句构成一个代码块，我们称之代码组。</p>
<p>像if、while、def和class这样的复合语句，首行以关键字开始，以冒号( : )结束，该行之后的一行或多行代码构成代码组。</p>
<p>我们将首行及后面的代码组称为一个子句(clause)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if expression : </span><br><span class="line">   suite </span><br><span class="line">elif expression :  </span><br><span class="line">   suite  </span><br><span class="line">else :  </span><br><span class="line">   suite</span><br></pre></td></tr></table></figure></p>
<h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><p>变量存储在内存中的值。这就意味着在创建变量时会在内存中开辟一个空间。</p>
<p>基于变量的数据类型，解释器会分配指定内存，并决定什么数据可以被存储在内存中。</p>
<p>因此，变量可以指定不同的数据类型，这些变量可以存储整数，小数或字符。</p>
<h4 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h4><ul>
<li>Python 中的变量赋值不需要类型声明。</li>
<li>每个变量在内存中创建，都包括变量的标识，名称和数据这些信息。</li>
<li>每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。</li>
<li>等号（=）用来给变量赋值。</li>
<li>等号（=）运算符左边是一个变量名,等号（=）运算符右边是存储在变量中的值。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">counter = 100 # 赋值整型变量</span><br><span class="line">miles = 1000.0 # 浮点型</span><br><span class="line">name = &quot;John&quot; # 字符串</span><br><span class="line"> </span><br><span class="line">print counter</span><br><span class="line">print miles</span><br><span class="line">print name</span><br></pre></td></tr></table></figure>
<h4 id="多个变量赋值"><a href="#多个变量赋值" class="headerlink" title="多个变量赋值"></a>多个变量赋值</h4><p>Python允许你同时为多个变量赋值。例如：<br>a = b = c = 1<br>以上实例，创建一个整型对象，值为1，三个变量被分配到相同的内存空间上。<br>您也可以为多个对象指定多个变量。例如：<br>a, b, c = 1, 2, “john”<br>以上实例，两个整型对象 1 和 2 分别分配给变量 a 和 b，字符串对象 “john” 分配给变量 c。</p>
<h4 id="标准数据类型"><a href="#标准数据类型" class="headerlink" title="标准数据类型"></a>标准数据类型</h4><p>在内存中存储的数据可以有多种类型。<br>例如，一个人的年龄可以用数字来存储，他的名字可以用字符来存储。<br>Python 定义了一些标准类型，用于存储各种类型的数据。<br>Python有五个标准的数据类型：</p>
<ul>
<li>Numbers（数字）</li>
<li>String（字符串）</li>
<li>List（列表）</li>
<li>Tuple（元组）</li>
<li>Dictionary（字典）</li>
</ul>
<h4 id="Python数字"><a href="#Python数字" class="headerlink" title="Python数字"></a>Python数字</h4><p>数字数据类型用于存储数值。</p>
<p>他们是不可改变的数据类型，这意味着改变数字数据类型会分配一个新的对象。</p>
<p>当你指定一个值时，Number对象就会被创建：</p>
<p>var1 = 1<br>var2 = 10<br>您也可以使用del语句删除一些对象的引用。<br>del语句的语法是：<br>del var1[,var2[,var3[….,varN]]]]<br>您可以通过使用del语句删除单个或多个对象的引用。例如：<br>del var<br>del var_a, var_b<br>Python支持四种不同的数字类型：</p>
<blockquote>
<p>int（有符号整型）<br>long（长整型[也可以代表八进制和十六进制]）<br>float（浮点型）<br>complex（复数）</p>
</blockquote>
<h4 id="Python字符串"><a href="#Python字符串" class="headerlink" title="Python字符串"></a>Python字符串</h4><p>字符串或串(String)是由数字、字母、下划线组成的一串字符。<br>一般记为 :<br>s=”a1a2···an”(n&gt;=0)<br>python的字串列表有2种取值顺序:</p>
<ul>
<li>从左到右索引默认0开始的，最大范围是字符串长度少1</li>
<li>从右到左索引默认-1开始的，最大范围是字符串开头</li>
</ul>
<p><img src="/2019/08/07/python基础1/01.png" alt="01.png"><br>如果你要实现从字符串中获取一段子字符串的话，可以使用 [头下标:尾下标] 来截取相应的字符串，其中下标是从 0 开始算起，可以是正数或负数，下标可以为空表示取到头或尾。<br>[头下标:尾下标] 获取的子字符串包含头下标的字符，但不包含尾下标的字符。<br>比如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = &apos;abcdef&apos;</span><br><span class="line">s[1:5]</span><br><span class="line">&apos;bcde&apos;</span><br></pre></td></tr></table></figure></p>
<p>当使用以冒号分隔的字符串，python 返回一个新的对象，结果包含了以这对偏移标识的连续的内容，左边的开始是包含了下边界。<br>上面的结果包含了 s[1] 的值 b，而取到的最大范围不包括尾下标，就是 s[5] 的值 f。<br><img src="/2019/08/07/python基础1/02.png" alt="02.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">str = &apos;Hello World!&apos;</span><br><span class="line">print str           # 输出完整字符串</span><br><span class="line">print str[0]        # 输出字符串中的第一个字符</span><br><span class="line">print str[2:5]      # 输出字符串中第三个至第六个之间的字符串</span><br><span class="line">print str[2:]       # 输出从第三个字符开始的字符串</span><br><span class="line">print str * 2       # 输出字符串两次</span><br><span class="line">print str + &quot;TEST&quot;  # 输出连接的字符串</span><br></pre></td></tr></table></figure></p>
<p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Hello World!</span><br><span class="line">H</span><br><span class="line">llo</span><br><span class="line">llo World!</span><br><span class="line">Hello World!Hello World!</span><br><span class="line">Hello World!TEST</span><br></pre></td></tr></table></figure></p>
<p>Python 列表截取可以接收第三个参数，参数作用是截取的步长，以下实例在索引 1 到索引 4 的位置并设置为步长为 2（间隔一个位置）来截取字符串：<br><img src="/2019/08/07/python基础1/03.png" alt="03.png"></p>
<h4 id="Python列表"><a href="#Python列表" class="headerlink" title="Python列表"></a>Python列表</h4><p>List（列表） 是 Python 中使用最频繁的数据类型。<br>列表可以完成大多数集合类的数据结构实现。它支持字符，数字，字符串甚至可以包含列表（即嵌套）。<br>列表用 [ ] 标识，是 python 最通用的复合数据类型。<br>列表中值的切割也可以用到变量 [头下标:尾下标] ，就可以截取相应的列表，从左到右索引默认 0 开始，从右到左索引默认 -1 开始，下标可以为空表示取到头或尾。<br><img src="/2019/08/07/python基础1/04.png" alt="04.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">list = [ &apos;runoob&apos;, 786 , 2.23, &apos;john&apos;, 70.2 ]</span><br><span class="line">tinylist = [123, &apos;john&apos;]</span><br><span class="line">print list               # 输出完整列表</span><br><span class="line">print list[0]            # 输出列表的第一个元素</span><br><span class="line">print list[1:3]          # 输出第二个至第三个元素 </span><br><span class="line">print list[2:]           # 输出从第三个开始至列表末尾的所有元素</span><br><span class="line">print tinylist * 2       # 输出列表两次</span><br><span class="line">print list + tinylist    # 打印组合的列表</span><br></pre></td></tr></table></figure></p>
<p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[&apos;runoob&apos;, 786, 2.23, &apos;john&apos;, 70.2]</span><br><span class="line">runoob</span><br><span class="line">[786, 2.23]</span><br><span class="line">[2.23, &apos;john&apos;, 70.2]</span><br><span class="line">[123, &apos;john&apos;, 123, &apos;john&apos;]</span><br><span class="line">[&apos;runoob&apos;, 786, 2.23, &apos;john&apos;, 70.2, 123, &apos;john&apos;]</span><br></pre></td></tr></table></figure></p>
<h4 id="Python-元组"><a href="#Python-元组" class="headerlink" title="Python 元组"></a>Python 元组</h4><p>元组是另一个数据类型，类似于 List（列表）。<br>元组用 () 标识。内部元素用逗号隔开。但是元组不能二次赋值，相当于只读列表。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">tuple = ( &apos;runoob&apos;, 786 , 2.23, &apos;john&apos;, 70.2 )</span><br><span class="line">tinytuple = (123, &apos;john&apos;)</span><br><span class="line"> </span><br><span class="line">print tuple               # 输出完整元组</span><br><span class="line">print tuple[0]            # 输出元组的第一个元素</span><br><span class="line">print tuple[1:3]          # 输出第二个至第四个（不包含）的元素 </span><br><span class="line">print tuple[2:]           # 输出从第三个开始至列表末尾的所有元素</span><br><span class="line">print tinytuple * 2       # 输出元组两次</span><br><span class="line">print tuple + tinytuple   # 打印组合的元组</span><br></pre></td></tr></table></figure></p>
<p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(&apos;runoob&apos;, 786, 2.23, &apos;john&apos;, 70.2)</span><br><span class="line">runoob</span><br><span class="line">(786, 2.23)</span><br><span class="line">(2.23, &apos;john&apos;, 70.2)</span><br><span class="line">(123, &apos;john&apos;, 123, &apos;john&apos;)</span><br><span class="line">(&apos;runoob&apos;, 786, 2.23, &apos;john&apos;, 70.2, 123, &apos;john&apos;)</span><br></pre></td></tr></table></figure></p>
<p>以下是元组无效的，因为元组是不允许更新的。而列表是允许更新的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">tuple = ( &apos;runoob&apos;, 786 , 2.23, &apos;john&apos;, 70.2 )</span><br><span class="line">list = [ &apos;runoob&apos;, 786 , 2.23, &apos;john&apos;, 70.2 ]</span><br><span class="line">tuple[2] = 1000    # 元组中是非法应用</span><br><span class="line">list[2] = 1000     # 列表中是合法应用</span><br></pre></td></tr></table></figure></p>
<h4 id="Python-字典"><a href="#Python-字典" class="headerlink" title="Python 字典"></a>Python 字典</h4><p>字典(dictionary)是除列表以外python之中最灵活的内置数据结构类型。列表是有序的对象集合，字典是无序的对象集合。<br>两者之间的区别在于：字典当中的元素是通过键来存取的，而不是通过偏移存取。<br>字典用”{ }”标识。字典由索引(key)和它对应的值value组成。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"> </span><br><span class="line">dict = &#123;&#125;</span><br><span class="line">dict[&apos;one&apos;] = &quot;This is one&quot;</span><br><span class="line">dict[2] = &quot;This is two&quot;</span><br><span class="line">tinydict = &#123;&apos;name&apos;: &apos;john&apos;,&apos;code&apos;:6734, &apos;dept&apos;: &apos;sales&apos;&#125;</span><br><span class="line">print dict[&apos;one&apos;]          # 输出键为&apos;one&apos; 的值</span><br><span class="line">print dict[2]              # 输出键为 2 的值</span><br><span class="line">print tinydict             # 输出完整的字典</span><br><span class="line">print tinydict.keys()      # 输出所有键</span><br><span class="line">print tinydict.values()    # 输出所有值</span><br></pre></td></tr></table></figure></p>
<p>输出结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is one</span><br><span class="line">This is two</span><br><span class="line">&#123;&apos;dept&apos;: &apos;sales&apos;, &apos;code&apos;: 6734, &apos;name&apos;: &apos;john&apos;&#125;</span><br><span class="line">[&apos;dept&apos;, &apos;code&apos;, &apos;name&apos;]</span><br><span class="line">[&apos;sales&apos;, 6734, &apos;john&apos;]</span><br></pre></td></tr></table></figure></p>
<h4 id="Python数据类型转换"><a href="#Python数据类型转换" class="headerlink" title="Python数据类型转换"></a>Python数据类型转换</h4><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>int(x [,base])</td>
<td>将x转换为一个整数</td>
</tr>
<tr>
<td>long(x [,base] )</td>
<td>将x转换为一个长整数</td>
</tr>
<tr>
<td>float(x)</td>
<td>将x转换到一个浮点数</td>
</tr>
<tr>
<td>complex(real [,imag])</td>
<td>创建一个复数</td>
</tr>
<tr>
<td>str(x)</td>
<td>将对象 x 转换为字符串</td>
</tr>
<tr>
<td>repr(x)</td>
<td>将对象 x 转换为表达式字符串</td>
</tr>
<tr>
<td>eval(str)</td>
<td>用来计算在字符串中的有效Python表达式,并返回一个对象</td>
</tr>
<tr>
<td>tuple(s)</td>
<td>将序列 s 转换为一个元组</td>
</tr>
<tr>
<td>list(s)</td>
<td>将序列 s 转换为一个列表</td>
</tr>
<tr>
<td>set(s)</td>
<td>转换为可变集合</td>
</tr>
<tr>
<td>dict(d)</td>
<td>创建一个字典。d 必须是一个序列 (key,value)元组。</td>
</tr>
<tr>
<td>frozenset(s)</td>
<td>转换为不可变集合</td>
</tr>
<tr>
<td>chr(x)</td>
<td>将一个整数转换为一个字符</td>
</tr>
<tr>
<td>unichr(x)</td>
<td>将一个整数转换为Unicode字符</td>
</tr>
<tr>
<td>ord(x)</td>
<td>将一个字符转换为它的整数值</td>
</tr>
<tr>
<td>hex(x)</td>
<td>将一个整数转换为一个十六进制字符串</td>
</tr>
<tr>
<td>oct(x)</td>
<td>将一个整数转换为一个八进制字符串</td>
</tr>
</tbody>
</table>
<h3 id="Python-运算符"><a href="#Python-运算符" class="headerlink" title="Python 运算符"></a>Python 运算符</h3><ul>
<li>算术运算符</li>
<li>比较（关系）运算符</li>
<li>赋值运算符</li>
<li>逻辑运算符</li>
<li>位运算符</li>
<li>成员运算符</li>
<li>身份运算符</li>
<li>运算符优先级</li>
</ul>
<h4 id="Python算术运算符"><a href="#Python算术运算符" class="headerlink" title="Python算术运算符"></a>Python算术运算符</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加 - 两个对象相加</td>
<td>a + b 输出结果 30</td>
</tr>
<tr>
<td>-</td>
<td>减 - 得到负数或是一个数减去另一个数</td>
<td>a - b 输出结果 -10</td>
</tr>
<tr>
<td>*</td>
<td>乘 - 两个数相乘或是返回一个被重复若干次的字符串</td>
<td>a * b 输出结果 200</td>
</tr>
<tr>
<td>/</td>
<td>除 - x除以y</td>
<td>b / a 输出结果 2</td>
</tr>
<tr>
<td>%</td>
<td>取模 - 返回除法的余数</td>
<td>b % a 输出结果 0</td>
</tr>
<tr>
<td>**</td>
<td>幂 - 返回x的y次幂 a**b 为10的20次方，</td>
<td>输出结果 100000000000000000000</td>
</tr>
<tr>
<td>//</td>
<td>取整除 - 返回商的整数部分（向下取整）</td>
<td>9//2    结果：4</td>
</tr>
</tbody>
</table>
<h4 id="Python比较运算符"><a href="#Python比较运算符" class="headerlink" title="Python比较运算符"></a>Python比较运算符</h4><p><img src="/2019/08/07/python基础1/05.png" alt="05.png"></p>
<h4 id="Python赋值运算符"><a href="#Python赋值运算符" class="headerlink" title="Python赋值运算符"></a>Python赋值运算符</h4><p><img src="/2019/08/07/python基础1/06.png" alt="06.png"></p>
<h4 id="Python位运算符"><a href="#Python位运算符" class="headerlink" title="Python位运算符"></a>Python位运算符</h4><p><img src="/2019/08/07/python基础1/07.png" alt="07.png"></p>
<h4 id="Python逻辑运算符"><a href="#Python逻辑运算符" class="headerlink" title="Python逻辑运算符"></a>Python逻辑运算符</h4><p><img src="/2019/08/07/python基础1/08.png" alt="08.png"></p>
<h4 id="Python成员运算符"><a href="#Python成员运算符" class="headerlink" title="Python成员运算符"></a>Python成员运算符</h4><p><img src="/2019/08/07/python基础1/09.png" alt="09.png"></p>
<h4 id="Python身份运算符"><a href="#Python身份运算符" class="headerlink" title="Python身份运算符"></a>Python身份运算符</h4><p><img src="/2019/08/07/python基础1/10.png" alt="10.png"></p>
<h4 id="Python运算符优先级"><a href="#Python运算符优先级" class="headerlink" title="Python运算符优先级"></a>Python运算符优先级</h4><p><img src="/2019/08/07/python基础1/11.png" alt="11.png"></p>

                
                <div class="readmore">
                    <a href="/2019/08/07/python基础1/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS25/">
                        ArcGIS API For Javascript之影像服务分析
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T10:08:42.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>  在前面我们大多数的程序是对矢量数据的操作，在这篇博客中，主要介绍影响服务的操作。在影像服务的操作中主要用到的类有：</p>
<ul>
<li>esri/tasks/ImageServiceIdentifyTask用于对影像数据的查询，它主要对应的参数为esri/tasks/ImageServiceIdentifyParameters,查询返回的结果用esri/tasks/ImageServiceIdentifyResult接受</li>
<li>对影像数据的测量主要用到的类为esri/tasks/ImageServiceMeasureTask,它所对应的的参数为esri/tasks/ImageServiceMeasureParameters</li>
</ul>
<h3 id="ArcGIS-API影像测量"><a href="#ArcGIS-API影像测量" class="headerlink" title="ArcGIS API影像测量"></a>ArcGIS API影像测量</h3><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>首先加载地图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">require([&quot;esri/map&quot;,&quot;esri/layers/ArcGISImageServiceLayer&quot;,&quot;dojo/domReady!&quot;],function(Map,ArcGISImageServiceLayer)&#123;</span><br><span class="line">        var map=new Map(&quot;mapDiv&quot;)</span><br><span class="line">        //注意这里是影响服务</span><br><span class="line">        var layer=new ArcGISImageServiceLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/Dem/ImageServer&quot;)</span><br><span class="line">        map.addLayer(layer);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
<p>添加两个按钮，一个用于绘制折线，一个用于测量分析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=&quot;drawp&quot;&gt;绘制点&lt;/button&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;查询&lt;/button&gt;</span><br></pre></td></tr></table></figure></p>
<p>创建必要对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//用于绘制点</span><br><span class="line">            var toolbar =new Draw(map);</span><br><span class="line">            </span><br><span class="line">            //创建影像分析对象</span><br><span class="line">            var task=new ImageServiceIdentifyTask(&quot;http://192.168.0.112:6080/arcgis/rest/services/Test/Dem1/ImageServer&quot;);</span><br><span class="line">            //创建影像分析参数对象</span><br><span class="line">            var params=new ImageServiceIdentifyParameters();</span><br><span class="line">            var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">            var marker= new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CIRCLE,10, lineSymbol, new dojo.Color([255, 0, 0]));</span><br><span class="line">            var fill= new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol,  new dojo.Color([255, 0, 0]));</span><br></pre></td></tr></table></figure></p>
<p>给绘制折现按钮添加绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//给绘制点按钮绑定事件</span><br><span class="line">            on(dom.byId(&quot;drawp&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                toolbar.activate(Draw.POLYLINE, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            //给draw工具的绘制完成事件绑定函数</span><br><span class="line">            on(toolbar,&quot;draw-complete&quot;, function (result) &#123;</span><br><span class="line">                var geometry=result.geometry;</span><br><span class="line">                //给参数对象的几何属性赋值</span><br><span class="line">                params.geometry=geometry;</span><br><span class="line">                toolbar.deactivate();</span><br><span class="line">            </span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
<p>给分析按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                //设置掩膜规则</span><br><span class="line">                var mosaicRule=new MosaicRule();</span><br><span class="line">                mosaicRule.ascending=false;</span><br><span class="line">                mosaicRule.method=MosaicRule.METHOD_CENTER</span><br><span class="line">                params.mosaicRule=mosaicRule</span><br><span class="line">                params.pixelSizeX=layer.pixelSizeX;</span><br><span class="line">                params.pixelSizeY=layer.pixelSizeY;</span><br><span class="line">                task.execute(params,function(result)&#123;</span><br><span class="line">                    //弹出改点的高程值</span><br><span class="line">                    alert(result.value)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="代码结果"><a href="#代码结果" class="headerlink" title="代码结果"></a>代码结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS25/04.png" alt="04.png"></p>
<h4 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;index.html&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        require([&quot;esri/map&quot;,&quot;esri/layers/ArcGISImageServiceLayer&quot;,&quot;dojo/on&quot;,</span><br><span class="line">        &quot;dojo/dom&quot;,&quot;esri/toolbars/draw&quot;,</span><br><span class="line">        &quot;esri/tasks/ImageServiceIdentifyTask&quot;,&quot;esri/tasks/ImageServiceIdentifyParameters&quot;,</span><br><span class="line">        &quot;esri/symbols/SimpleLineSymbol&quot;,&quot;esri/graphic&quot;,&quot;esri/symbols/SimpleMarkerSymbol&quot;, &quot;esri/symbols/SimpleFillSymbol&quot;,</span><br><span class="line">        &quot;esri/layers/MosaicRule&quot;,</span><br><span class="line">        &quot;dojo/domReady!&quot;],function(Map,ArcGISImageServiceLayer,on,dom,Draw,ImageServiceIdentifyTask,</span><br><span class="line">        ImageServiceIdentifyParameters,SimpleLineSymbol,</span><br><span class="line">        Graphic,SimpleMarkerSymbol,SimpleFillSymbol,MosaicRule)&#123;</span><br><span class="line">            var map=new Map(&quot;mapDiv&quot;)</span><br><span class="line"></span><br><span class="line">            //注意这里是影响服务</span><br><span class="line">            var layer=new ArcGISImageServiceLayer(&quot;http://192.168.0.112:6080/arcgis/rest/services/Test/Dem1/ImageServer&quot;)</span><br><span class="line">            map.addLayer(layer);</span><br><span class="line">            //用于绘制点</span><br><span class="line">            var toolbar =new Draw(map);</span><br><span class="line">            </span><br><span class="line">            //创建影像分析对象</span><br><span class="line">            var task=new ImageServiceIdentifyTask(&quot;http://192.168.0.112:6080/arcgis/rest/services/Test/Dem1/ImageServer&quot;);</span><br><span class="line">            //创建影像分析参数对象</span><br><span class="line">            var params=new ImageServiceIdentifyParameters();</span><br><span class="line">            var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">            var marker= new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CIRCLE,10, lineSymbol, new dojo.Color([255, 0, 0]));</span><br><span class="line">            var fill= new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol,  new dojo.Color([255, 0, 0]));</span><br><span class="line">            //给绘制折线按钮绑定事件</span><br><span class="line">            on(dom.byId(&quot;drawp&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                toolbar.activate(Draw.POINT, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            //给draw工具的绘制完成事件绑定函数</span><br><span class="line">            on(toolbar,&quot;draw-complete&quot;, function (result) &#123;</span><br><span class="line">                map.graphics.clear();</span><br><span class="line">                var geometry=result.geometry;</span><br><span class="line">                //给参数对象的几何属性赋值</span><br><span class="line">                params.geometry =geometry;</span><br><span class="line">                graphic= new Graphic(geometry, marker);</span><br><span class="line">                map.graphics.add(graphic);</span><br><span class="line">                toolbar.deactivate();</span><br><span class="line">            </span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">            on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                //设置掩膜规则</span><br><span class="line">                var mosaicRule=new MosaicRule();</span><br><span class="line">                mosaicRule.ascending=false;</span><br><span class="line">                mosaicRule.method=MosaicRule.METHOD_CENTER</span><br><span class="line">                params.mosaicRule=mosaicRule</span><br><span class="line">                params.pixelSizeX=layer.pixelSizeX;</span><br><span class="line">                params.pixelSizeY=layer.pixelSizeY;</span><br><span class="line">                task.execute(params,function(result)&#123;</span><br><span class="line">                    //弹出改点的高程值</span><br><span class="line">                    alert(result.value)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;mapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;button id=&quot;drawp&quot;&gt;绘制点&lt;/button&gt;</span><br><span class="line">    &lt;button id=&quot;btn&quot;&gt;查询&lt;/button&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS25/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS24/">
                        ArcGIS API For Javascript之调用地理编码服务
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T10:03:13.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>地理编码（Geocoding）指建立地理位置坐标与给定地址一致性的过程，简单的说就是将一个地址的描述信息映射为地图上该地址所对应的空间位置。<br>      根据输入的地址找到对应的空间信息。当输入一个地址的时候，可能会查到好多个空间位置，程序会给每一个位置一个打分，匹配的越完全的比分越高。（注意这里说的）</p>
<h3 id="调用地理编码服务"><a href="#调用地理编码服务" class="headerlink" title="调用地理编码服务"></a>调用地理编码服务</h3><h4 id="查看我们发布的服务"><a href="#查看我们发布的服务" class="headerlink" title="查看我们发布的服务"></a>查看我们发布的服务</h4><p>首先看一下发布的服务数据<br><img src="/2019/08/06/ArcGIS-API-for-JS24/01.png" alt="01.png"><br>我发布的地理编码服务是：name为主键</p>
<p>注意应该输入的参数<br><img src="/2019/08/06/ArcGIS-API-for-JS24/02.png" alt="02.png"></p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>添加地图（略）<br>创建三个html要素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Name:&lt;input class=&quot;nm&quot; type=&quot;text&quot;&gt;</span><br><span class="line">&lt;input id=&quot;btn&quot; type=&quot;button&quot; value=&quot;定位&quot;&gt;</span><br><span class="line">&lt;div id=&quot;divShowResult&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>给定位按钮添加绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//执行方法</span><br><span class="line">                        locator.addressToLocations(options,function(candidates)&#123;</span><br><span class="line">                            //获得运行之后的信息</span><br><span class="line">                            if (candidates.length &gt; 0)&#123;</span><br><span class="line">                                    //拼接字符串</span><br><span class="line">                                    var htmls = &quot;&lt;table style=&apos;width: 100%&apos;&gt;&quot;; </span><br><span class="line">                                    htmls = htmls + &quot;&lt;tr bgcolor=&apos;#E0E0E0&apos;&gt;&lt;td&gt;X 坐标&lt;/td&gt;&lt;td&gt;Y 坐标&lt;/td&gt;&lt;td&gt;得分&lt;/td&gt;&lt;/tr&gt;&quot;; </span><br><span class="line">                                    array.forEach(candidates, function (candidate, index) &#123;  </span><br><span class="line">                                        if (index % 2 == 1) &#123; </span><br><span class="line">                                            htmls = htmls + &quot;&lt;tr  bgcolor=&apos;#E0E0E0&apos;&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.x + &quot;&lt;/td&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.y+ &quot;&lt;/td&gt;&lt;td&gt;&quot; + candidate.score + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;; </span><br><span class="line">                                        &#125; else &#123; </span><br><span class="line">                                            htmls = htmls + &quot;&lt;tr&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.x + &quot;&lt;/td&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.y+ &quot;&lt;/td&gt;&lt;td&gt;&quot; + candidate.score + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;</span><br><span class="line">                                        &#125;                                       </span><br><span class="line">                                    &#125;); </span><br><span class="line">                                    htmls = htmls + &quot;&lt;/table&gt;&quot;; </span><br><span class="line">                                    //将拼接的字符串显示在页面上</span><br><span class="line">                                    dom.byId(&quot;divShowResult&quot;).innerHTML = htmls;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,function(error)&#123;alert(error)&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS24/03.png" alt="03.png"></p>
<h4 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;gbk&quot;&gt;</span><br><span class="line">    &lt;title&gt;Hello World&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,&quot;dojo/query&quot;,&quot;dojo/on&quot;,&quot;dojo/_base/array&quot;,&quot;dojo/dom&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/tasks/locator&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;dojo/colors&quot;,</span><br><span class="line">            &quot;esri/InfoTemplate&quot;,&quot;esri/graphic&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;],</span><br><span class="line">                function(Map,query,on,array,dom,ArcGISDynamicMapServiceLayer,Locator,SimpleMarkerSymbol,Color,InfoTemplate,Graphic)&#123;</span><br><span class="line">                    var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">                    var layer=new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer&quot;);</span><br><span class="line">                    map.addLayer(layer);</span><br><span class="line">                    query(&quot;#btn&quot;).on(&quot;click&quot;,function()&#123;</span><br><span class="line">                        //获得教学楼的名称</span><br><span class="line">                        var name=query(&quot;.nm&quot;)[0].value;</span><br><span class="line">                        //创建地理编码对象</span><br><span class="line">                        var locator = new Locator(&quot;http://localhost:6080/arcgis/rest/services/Test/nameLoc/GeocodeServer&quot;);</span><br><span class="line">                        //注意这里的参数要和服务的参数对应</span><br><span class="line">                        var address = &#123; &quot;Single Line Input&quot;: name&#125;; </span><br><span class="line">                        //输出的空间参考</span><br><span class="line">                        locator.outSpatialReference = map.spatialReference; </span><br><span class="line">                        var options = &#123; </span><br><span class="line">                            address: address, </span><br><span class="line">                            outFields: [&quot;*&quot;] </span><br><span class="line">                        &#125; </span><br><span class="line">                        //执行方法</span><br><span class="line">                        locator.addressToLocations(options,function(candidates)&#123;</span><br><span class="line">                            //获得运行之后的信息</span><br><span class="line">                            if (candidates.length &gt; 0)&#123;</span><br><span class="line">                                    //拼接字符串</span><br><span class="line">                                    var htmls = &quot;&lt;table style=&apos;width: 100%&apos;&gt;&quot;; </span><br><span class="line">                                    htmls = htmls + &quot;&lt;tr bgcolor=&apos;#E0E0E0&apos;&gt;&lt;td&gt;X 坐标&lt;/td&gt;&lt;td&gt;Y 坐标&lt;/td&gt;&lt;td&gt;得分&lt;/td&gt;&lt;/tr&gt;&quot;; </span><br><span class="line">                                    array.forEach(candidates, function (candidate, index) &#123;  </span><br><span class="line">                                        if (index % 2 == 1) &#123; </span><br><span class="line">                                            htmls = htmls + &quot;&lt;tr  bgcolor=&apos;#E0E0E0&apos;&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.x + &quot;&lt;/td&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.y+ &quot;&lt;/td&gt;&lt;td&gt;&quot; + candidate.score + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;; </span><br><span class="line">                                        &#125; else &#123; </span><br><span class="line">                                            htmls = htmls + &quot;&lt;tr&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.x + &quot;&lt;/td&gt;&lt;td style=&apos;width: 60px&apos;&gt;&quot; + candidate.location.y+ &quot;&lt;/td&gt;&lt;td&gt;&quot; + candidate.score + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;</span><br><span class="line">                                        &#125;                                       </span><br><span class="line">                                    &#125;); </span><br><span class="line">                                    htmls = htmls + &quot;&lt;/table&gt;&quot;; </span><br><span class="line">                                    //将拼接的字符串显示在页面上</span><br><span class="line">                                    dom.byId(&quot;divShowResult&quot;).innerHTML = htmls;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,function(error)&#123;alert(error)&#125;);                               &#125;);                             </span><br><span class="line">                &#125;);</span><br><span class="line">                       </span><br><span class="line">                              </span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body class=&quot;tundra&quot;&gt;</span><br><span class="line">&lt;div id=&quot;mapDiv&quot; style=&quot;width:900px; height:580px; border:1px solid #000;&quot;&gt;&lt;/div&gt;</span><br><span class="line">    Name:&lt;input class=&quot;nm&quot; type=&quot;text&quot;&gt;</span><br><span class="line">    &lt;input id=&quot;btn&quot; type=&quot;button&quot; value=&quot;定位&quot;&gt;</span><br><span class="line">    &lt;div id=&quot;divShowResult&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS24/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS23/">
                        ArcGIS API For Javascript之地图输出
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T09:54:17.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>在WebGIS中地图输出是一个比较常用的功能，当我们制图结束时，往往要将我们的地图打印成一张图片保存起来，在ArcGIS API要想实现地图打印，需要借助PrintingTools工具，此工具实质上是一个GP工具，因为是GP工具，所以地图的生成是在服务器端生成的，也可以叫做服务器端打印.<br>服务器端打印的执行对象是 PrintTask，打印的参数是 PrintParameters，通过设置打印模板对象PrintTemplate，可以对图片的大小，像素，格式等进行设置</p>
<h3 id="启用PrintingTools-工具"><a href="#启用PrintingTools-工具" class="headerlink" title="启用PrintingTools 工具"></a>启用PrintingTools 工具</h3><p>PrintingTools 和几何服务一样，默认情况下是关闭的，我们应当开启此工具<br>默认情况下关闭<br><img src="/2019/08/06/ArcGIS-API-for-JS23/01.png" alt="01.png"><br>启动成功<br><img src="/2019/08/06/ArcGIS-API-for-JS23/02.png" alt="02.png"><br>要使用的URL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:6080/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task</span><br></pre></td></tr></table></figure></p>
<h3 id="使用PrintingTools-打印地图"><a href="#使用PrintingTools-打印地图" class="headerlink" title="使用PrintingTools 打印地图"></a>使用PrintingTools 打印地图</h3><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>加载地图（略）<br>添加两个按钮（一个按钮用于画polygon，一个按钮用于地图打印）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button class=&quot;pbtn&quot; &gt;画多边形&lt;/button&gt;</span><br><span class="line">&lt;input id=&quot;Btn&quot; type=&quot;button&quot; value=&quot;地图打印&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>创建相关对象（例如：绘图对象，符号对象）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//创建绘图对象</span><br><span class="line">var toolBar = new Draw(map);        </span><br><span class="line">//线符号</span><br><span class="line">lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">//面符号</span><br><span class="line">polygonSymbol = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 0, 0, 0.25]));</span><br></pre></td></tr></table></figure></p>
<p>给绘制多边形按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//给绘制polygon的按钮绑定事件</span><br><span class="line">query(&quot;.pbtn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">    //激活绘制多边形</span><br><span class="line">    toolBar.activate(Draw.POLYGON, &#123;</span><br><span class="line">        showTooltips:true</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line">//绘图结束绑定事件</span><br><span class="line">on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">    //获得面形状</span><br><span class="line">    var geometry=result.geometry;</span><br><span class="line">    //创建Graphic</span><br><span class="line">    var graphicpoint= new Graphic(geometry, polygonSymbol);</span><br><span class="line">    map.graphics.add(graphicpoint); </span><br><span class="line">    //关闭绘图工具</span><br><span class="line">    toolBar.deactivate();                   </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>给地图打印按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//给地图打印按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //创建地图打印对象</span><br><span class="line">                    var printMap = new PrintTask(&quot;http://localhost:6080/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&quot;);</span><br><span class="line">                    //创建地图打印模版</span><br><span class="line">                    var template = new PrintTemplate();</span><br><span class="line">                    //创建地图的打印参数，参数里面包括：模版和地图</span><br><span class="line">                    var params = new PrintParameters(); </span><br><span class="line">                    //输出图片的空间参考</span><br><span class="line">                    printMap.outSpatialReference = map.SpatialReference </span><br><span class="line">                    //打印图片的各种参数</span><br><span class="line">                    template.exportOptions = &#123; </span><br><span class="line">                        width: 850, </span><br><span class="line">                        height: 650, </span><br><span class="line">                        dpi: 96 </span><br><span class="line">                    &#125;;</span><br><span class="line">                    //打印输出的格式</span><br><span class="line">                    template.format = &quot;PDF&quot;; </span><br><span class="line">                    //输出地图的布局</span><br><span class="line">                    template.layout = &quot;MAP_ONLY&quot;; </span><br><span class="line">                    PrintTemplate </span><br><span class="line">                    //设置参数地图</span><br><span class="line">                    params.map = map; </span><br><span class="line">                    //设置参数模版</span><br><span class="line">                    params.template = template; </span><br><span class="line">                    //运行结果</span><br><span class="line">                    printMap.execute(params, function(result)&#123;</span><br><span class="line">                        if (result != null) &#123; </span><br><span class="line">                            //网页打开生成的地图</span><br><span class="line">                            window.open(result.url); </span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS23/03.png" alt="03.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS23/04.png" alt="04.png"></p>
<h4 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;地图打印&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,&quot;dojo/on&quot;,&quot;dojo/query&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleFillSymbol&quot;,</span><br><span class="line">            &quot;esri/toolbars/draw&quot;,</span><br><span class="line">            &quot;esri/graphic&quot;,</span><br><span class="line">            &quot;esri/tasks/PrintTask&quot;,</span><br><span class="line">            &quot;esri/tasks/PrintTemplate&quot;,</span><br><span class="line">            &quot;esri/tasks/PrintParameters&quot;,</span><br><span class="line">            &quot;dojo/colors&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;],</span><br><span class="line">            function (Map,dom,on,query,</span><br><span class="line">                ArcGISDynamicMapServiceLayer,</span><br><span class="line">                SimpleMarkerSymbol,</span><br><span class="line">                SimpleLineSymbol,</span><br><span class="line">                SimpleFillSymbol,</span><br><span class="line">                Draw,</span><br><span class="line">                Graphic,</span><br><span class="line">                PrintTask,PrintTemplate,PrintParameters,</span><br><span class="line">                Color) &#123;</span><br><span class="line">                var map = new esri.Map(&quot;mapDiv&quot;);</span><br><span class="line">                var layer = new esri.layers.ArcGISDynamicMapServiceLayer</span><br><span class="line">                (&quot;http://localhost:6080/arcgis/rest/services/Test/ft/MapServer&quot;);</span><br><span class="line">                map.addLayer(layer);</span><br><span class="line">                //创建绘图对象</span><br><span class="line">                var toolBar = new Draw(map);    </span><br><span class="line">                //线符号</span><br><span class="line">                lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //面符号</span><br><span class="line">                polygonSymbol = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 0, 0, 0.25]));</span><br><span class="line">                </span><br><span class="line">                //给绘制polygon的按钮绑定事件</span><br><span class="line">                query(&quot;.pbtn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                    //激活绘制多边形</span><br><span class="line">                    toolBar.activate(Draw.POLYGON, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                    &#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line">                //绘图结束绑定事件</span><br><span class="line">                on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">                    //获得面形状</span><br><span class="line">                    var geometry=result.geometry;</span><br><span class="line">                    //创建Graphic</span><br><span class="line">                    var graphicpoint= new Graphic(geometry, polygonSymbol);</span><br><span class="line">                    map.graphics.add(graphicpoint); </span><br><span class="line">                    //关闭绘图工具</span><br><span class="line">                    toolBar.deactivate();                   </span><br><span class="line">                &#125;)</span><br><span class="line">                //给地图打印按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //创建地图打印对象</span><br><span class="line">                    var printMap = new PrintTask(&quot;http://localhost:6080/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&quot;);</span><br><span class="line">                    //创建地图打印模版</span><br><span class="line">                    var template = new PrintTemplate();</span><br><span class="line">                    //创建地图的打印参数，参数里面包括：模版和地图</span><br><span class="line">                    var params = new PrintParameters(); </span><br><span class="line">                    //输出图片的空间参考</span><br><span class="line">                    printMap.outSpatialReference = map.SpatialReference </span><br><span class="line">                    //打印图片的各种参数</span><br><span class="line">                    template.exportOptions = &#123; </span><br><span class="line">                        width: 850, </span><br><span class="line">                        height: 650, </span><br><span class="line">                        dpi: 96 </span><br><span class="line">                    &#125;;</span><br><span class="line">                    //打印输出的格式</span><br><span class="line">                    template.format = &quot;PDF&quot;; </span><br><span class="line">                    //输出地图的布局</span><br><span class="line">                    template.layout = &quot;MAP_ONLY&quot;; </span><br><span class="line">                    PrintTemplate </span><br><span class="line">                    //设置参数地图</span><br><span class="line">                    params.map = map; </span><br><span class="line">                    //设置参数模版</span><br><span class="line">                    params.template = template; </span><br><span class="line">                    //运行结果</span><br><span class="line">                    printMap.execute(params, function(result)&#123;</span><br><span class="line">                        if (result != null) &#123; </span><br><span class="line">                            //网页打开生成的地图</span><br><span class="line">                            window.open(result.url); </span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;) </span><br><span class="line">                &#125;)</span><br><span class="line">               </span><br><span class="line">            &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;mapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;button class=&quot;pbtn&quot; &gt;画多边形&lt;/button&gt;</span><br><span class="line">    &lt;input id=&quot;Btn&quot; type=&quot;button&quot; value=&quot;地图打印&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS23/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS22/">
                        ArcGIS API For Javascript之几何服务
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T09:43:13.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>什么是几何服务（GeometryService）？从字面意义上来说是和几何（Geometry）相关的服务，具体一点讲我们可以用这个类实现一些简单的图形操作。例如：</p>
<ul>
<li>测量直线的距离</li>
<li>形状的缓冲区分析</li>
<li>判断两个形状之间的关系（相交，相离等等）</li>
<li>两个形状求交</li>
<li>对形状的裁剪等等</li>
</ul>
<p>在此以缓冲区分析和图形求交来介绍几何服务的使用.</p>
<h3 id="启用几何服务"><a href="#启用几何服务" class="headerlink" title="启用几何服务"></a>启用几何服务</h3><p>当我们安装好ArcGIS Server的时候，几何服务就已经存在了，因此几何服务不需要我们发布，但是在默认情况下几何服务是关闭的，因此我们首先启动几何服务，步骤如下：</p>
<p>登录我们的ArcGIS Server Manager<br><img src="/2019/08/06/ArcGIS-API-for-JS22/01.png" alt="01.png"><br>启动成功<br><img src="/2019/08/06/ArcGIS-API-for-JS22/02.png" alt="02.png"><br>几何服务的URL<br><img src="/2019/08/06/ArcGIS-API-for-JS22/03.png" alt="03.png"></p>
<h3 id="利用几何服务进行缓冲区分析"><a href="#利用几何服务进行缓冲区分析" class="headerlink" title="利用几何服务进行缓冲区分析"></a>利用几何服务进行缓冲区分析</h3><p>几何服务的使用一般分为四个步骤：</p>
<ul>
<li>创建几何服务对象</li>
<li>创建参数</li>
<li>构建参数对象</li>
<li>执行相应的方法，并处理返回的结果</li>
</ul>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>加载地图（省略）<br>创建两个按钮–一个按钮用于画点，另外一个按钮用于缓冲区分析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=&quot;point&quot; type=&quot;button&quot; value=&quot;点&quot;/&gt;</span><br><span class="line">&lt;input id=&quot;Btn&quot; type=&quot;button&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>创建相关对象（例如符号对象，Draw对象等等）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//使用toolbar上的绘图工具</span><br><span class="line">                var toolBar = new Draw(map);</span><br><span class="line">                //创建点符号</span><br><span class="line">                var pointSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                pointSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                pointSymbol.setSize(12);</span><br><span class="line">                pointSymbol.setColor(new Color(&quot;#FFFFCC&quot;));</span><br><span class="line">                //线符号</span><br><span class="line">                lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //面符号</span><br><span class="line">                polygonSymbol= new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 255, 0, 0.25]));</span><br></pre></td></tr></table></figure></p>
<p>创建几何服务对象，创建相应的缓冲区参数对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var geometryServices = new GeometryService(&quot;http://localhost:6080/arcgis/rest/services/Utilities/Geometry/GeometryServer&quot;);</span><br><span class="line">var params = new BufferParameters();</span><br></pre></td></tr></table></figure></p>
<p>给画点按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//给画点按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;point&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //激活画点工具</span><br><span class="line">                    toolBar.activate(Draw.POINT, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                    &#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">                //绘图结束绑定事件</span><br><span class="line">                on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">                    //获得点形状</span><br><span class="line">                    var geometry=result.geometry;</span><br><span class="line">                    //创建Graphic</span><br><span class="line">                    var graphicpoint = new Graphic(geometry, pointSymbol);</span><br><span class="line">                    map.graphics.add(graphicpoint); </span><br><span class="line">                    //关闭绘图工具</span><br><span class="line">                    toolBar.deactivate();</span><br><span class="line">                    //很重要！！！在这里构建缓冲区分析的形状属性</span><br><span class="line">                    //注意这里可以放一个数组，此处为了方便我们只对一个形状进行缓冲区分析</span><br><span class="line">                    params.geometries  = [ geometry ];</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<p>给缓冲区分析按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//给缓冲区分析按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //缓冲距离</span><br><span class="line">                    params.distances = [ &quot;80&quot; ];</span><br><span class="line">                    //空间参考</span><br><span class="line">                    params.bufferSpatialReference = map.spatialReference;</span><br><span class="line">                    params.outSpatialReference = map.spatialReference;</span><br><span class="line">                    //执行分析处理结果</span><br><span class="line">                    geometryServices.buffer(params,function(result)&#123;</span><br><span class="line">                        //处理缓冲区分析得到的结果</span><br><span class="line">                        for(var idx in result)</span><br><span class="line">                        &#123;   </span><br><span class="line">                            //创建Graphic</span><br><span class="line">                            var graphic=new Graphic(result[idx],polygonSymbol)</span><br><span class="line">                            //将每一个结果都放在map中</span><br><span class="line">                            map.graphics.add(graphic)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS22/04.png" alt="04.png"></p>
<h4 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;缓冲区分析&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,&quot;dojo/on&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleFillSymbol&quot;,</span><br><span class="line">            &quot;esri/toolbars/draw&quot;,</span><br><span class="line">            &quot;esri/graphic&quot;,</span><br><span class="line">            &quot;esri/tasks/GeometryService&quot;,</span><br><span class="line">            &quot;esri/tasks/BufferParameters&quot;,</span><br><span class="line">            &quot;dojo/colors&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;],</span><br><span class="line">            function (Map,dom,on,</span><br><span class="line">                ArcGISDynamicMapServiceLayer,</span><br><span class="line">                SimpleMarkerSymbol,</span><br><span class="line">                SimpleLineSymbol,</span><br><span class="line">                SimpleFillSymbol,</span><br><span class="line">                Draw,</span><br><span class="line">                Graphic,</span><br><span class="line">                GeometryService,</span><br><span class="line">                BufferParameters,Color) &#123;</span><br><span class="line">                var map = new esri.Map(&quot;mapDiv&quot;);</span><br><span class="line">                var layer = new esri.layers.ArcGISDynamicMapServiceLayer</span><br><span class="line">                (&quot;http://localhost:6080/arcgis/rest/services/Test/ft/MapServer&quot;);</span><br><span class="line">                map.addLayer(layer);</span><br><span class="line">                //创建几何服务对象</span><br><span class="line">                var geometryServices = new GeometryService(&quot;http://localhost:6080/arcgis/rest/services/Utilities/Geometry/GeometryServer&quot;);</span><br><span class="line">                //创建缓存参数对象</span><br><span class="line">                var params = new BufferParameters();</span><br><span class="line">                </span><br><span class="line">                //使用toolbar上的绘图工具</span><br><span class="line">                var toolBar = new Draw(map);</span><br><span class="line">                //创建点符号</span><br><span class="line">                var pointSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                pointSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                pointSymbol.setSize(12);</span><br><span class="line">                pointSymbol.setColor(new Color(&quot;#FFFFCC&quot;));</span><br><span class="line">                //线符号</span><br><span class="line">                lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //面符号</span><br><span class="line">                polygonSymbol = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 255, 0, 0.25]));</span><br><span class="line">                //给画点按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;point&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //激活画点工具</span><br><span class="line">                    toolBar.activate(Draw.POINT, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                    &#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line">                //绘图结束绑定事件</span><br><span class="line">                on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">                    //获得点形状</span><br><span class="line">                    var geometry=result.geometry;</span><br><span class="line">                    //创建Graphic</span><br><span class="line">                    var graphicpoint = new Graphic(geometry, pointSymbol);</span><br><span class="line">                    map.graphics.add(graphicpoint); </span><br><span class="line">                    //关闭绘图工具</span><br><span class="line">                    toolBar.deactivate();</span><br><span class="line">                    //很重要！！！在这里构建缓冲区分析的形状属性</span><br><span class="line">                    //注意这里可以放一个数组，此处为了方便我们只对一个形状进行缓冲区分析</span><br><span class="line">                    params.geometries  = [ geometry ];</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line">                //给缓冲区分析按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //缓冲距离</span><br><span class="line">                    params.distances = [ &quot;80&quot; ];</span><br><span class="line">                    //空间参考</span><br><span class="line">                    params.bufferSpatialReference = map.spatialReference;</span><br><span class="line">                    params.outSpatialReference = map.spatialReference;</span><br><span class="line">                    //执行分析处理结果</span><br><span class="line">                    geometryServices.buffer(params,function(result)&#123;</span><br><span class="line">                        //处理缓冲区分析得到的结果</span><br><span class="line">                        for(var idx in result)</span><br><span class="line">                        &#123;   </span><br><span class="line">                            //创建Graphic</span><br><span class="line">                            var graphic=new Graphic(result[idx],polygonSymbol)</span><br><span class="line">                            //将每一个结果都放在map中</span><br><span class="line">                            map.graphics.add(graphic)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;)</span><br><span class="line">               </span><br><span class="line">            &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;mapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;input id=&quot;point&quot; type=&quot;button&quot; value=&quot;点&quot;/&gt;</span><br><span class="line">    &lt;input id=&quot;Btn&quot; type=&quot;button&quot; value=&quot;缓冲区分析&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="利用几何服务进行多边形求交"><a href="#利用几何服务进行多边形求交" class="headerlink" title="利用几何服务进行多边形求交"></a>利用几何服务进行多边形求交</h3><p>首先我们先看看求交这一个方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GeometryService.intersect(geometries, geometry, callback?, errback?)</span><br></pre></td></tr></table></figure></p>
<p>解释：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">此方法有四个参数，</span><br><span class="line">第一个参数是   形状的集合(多个形状)</span><br><span class="line">第二个参数是   一个形状</span><br><span class="line">第三个参数是   运行成功之后的结果</span><br><span class="line">第四个参数是   运行失败之后的结果</span><br></pre></td></tr></table></figure></p>
<p>方法的使用：用第二个参数的形状与第一个参数的多个形状进行求交，从而返回运行的结果</p>
<h4 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h4><p>加载地图（略）<br>创建三个按钮<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button class=&quot;pbtn&quot; &gt;第一个参数&lt;/button&gt;</span><br><span class="line">&lt;button class=&quot;pbtn&quot; &gt;第二个参数&lt;/button&gt;</span><br><span class="line">&lt;input id=&quot;Btn&quot; type=&quot;button&quot; value=&quot;求交分析&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>创建相关对象（符号对象，绘图对象）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//一个标志位，用于记录是绘制第几个参数</span><br><span class="line">                //1代表第一个参数</span><br><span class="line">                //2代表第二个参数</span><br><span class="line">                var flag;</span><br><span class="line">                //第一个参数  注意第一个参数是多个形状</span><br><span class="line">                var geometries=[];</span><br><span class="line">                //第二个参数  注意第二个参数是一个形状</span><br><span class="line">                var paramGeometry;</span><br><span class="line">                //使用toolbar上的绘图工具</span><br><span class="line">                var toolBar = new Draw(map);</span><br><span class="line">                </span><br><span class="line">                //线符号</span><br><span class="line">                lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //第一个参数的面符号</span><br><span class="line">                polygonSymbol1 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 0, 0, 0.25]));</span><br><span class="line">                //第二个参数的面符号</span><br><span class="line">                polygonSymbol2 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([0, 255, 0, 0.25]));</span><br><span class="line">                //求交之后的面符号</span><br><span class="line">                polygonSymbol3 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([0, 0, 255, 0.25]));</span><br></pre></td></tr></table></figure></p>
<p>给画图形的按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">//给绘制polygon的按钮绑定事件</span><br><span class="line">                query(&quot;.pbtn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                    var value=this.innerHTML;</span><br><span class="line">                    switch(value)&#123;</span><br><span class="line">                        case &quot;第一个参数&quot;:&#123;</span><br><span class="line">                            flag=1;</span><br><span class="line">                            break;</span><br><span class="line">                            </span><br><span class="line">                        &#125;</span><br><span class="line">                        case &quot;第二个参数&quot;:&#123;</span><br><span class="line">                            flag=2;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;   </span><br><span class="line">                    &#125;</span><br><span class="line">                    //激活绘制多边形</span><br><span class="line">                    toolBar.activate(Draw.POLYGON, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                    &#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line">                //绘图结束绑定事件</span><br><span class="line">                on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">                    //获得面形状</span><br><span class="line">                    var geometry=result.geometry;</span><br><span class="line">                    //创建Graphic</span><br><span class="line">                    var graphicpoint;</span><br><span class="line"></span><br><span class="line">                    //很重要！！！在这里构建参数对象</span><br><span class="line">                    if(flag==1)</span><br><span class="line">                    &#123;</span><br><span class="line">                        //创建Graphic</span><br><span class="line">                        graphicpoint = new Graphic(geometry, polygonSymbol1);</span><br><span class="line">                        geometries.push(geometry)</span><br><span class="line">                    &#125;</span><br><span class="line">                    else if(flag==2)</span><br><span class="line">                    &#123;</span><br><span class="line">                        //创建Graphic</span><br><span class="line">                        graphicpoint = new Graphic(geometry, polygonSymbol2);</span><br><span class="line">                        paramGeometry=geometry;</span><br><span class="line">                    &#125;   </span><br><span class="line">                    map.graphics.add(graphicpoint); </span><br><span class="line">                    //关闭绘图工具</span><br><span class="line">                    toolBar.deactivate();                   </span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<p>给求交按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//给求交按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //在这里在说一边，第一个参数是图形集合，第二个参数是一个图形</span><br><span class="line">                    geometryServices.intersect(geometries,paramGeometry,function(result)&#123;</span><br><span class="line">                        for(var idx in result)</span><br><span class="line">                        &#123;</span><br><span class="line">                            //创建Graphic</span><br><span class="line">                            var graphic=new Graphic(result[idx],polygonSymbol3)</span><br><span class="line">                            //将每一个结果都放在map中</span><br><span class="line">                            map.graphics.add(graphic)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="运行结果-1"><a href="#运行结果-1" class="headerlink" title="运行结果"></a>运行结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS22/05.png" alt="05.png"></p>
<h4 id="全部代码-1"><a href="#全部代码-1" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;多边形求交&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,&quot;dojo/on&quot;,&quot;dojo/query&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleFillSymbol&quot;,</span><br><span class="line">            &quot;esri/toolbars/draw&quot;,</span><br><span class="line">            &quot;esri/graphic&quot;,</span><br><span class="line">            &quot;esri/tasks/GeometryService&quot;,</span><br><span class="line">            &quot;dojo/colors&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;],</span><br><span class="line">            function (Map,dom,on,query,</span><br><span class="line">                ArcGISDynamicMapServiceLayer,</span><br><span class="line">                SimpleMarkerSymbol,</span><br><span class="line">                SimpleLineSymbol,</span><br><span class="line">                SimpleFillSymbol,</span><br><span class="line">                Draw,</span><br><span class="line">                Graphic,</span><br><span class="line">                GeometryService,</span><br><span class="line">                Color) &#123;</span><br><span class="line">                var map = new esri.Map(&quot;mapDiv&quot;);</span><br><span class="line">                var layer = new esri.layers.ArcGISDynamicMapServiceLayer</span><br><span class="line">                (&quot;http://localhost:6080/arcgis/rest/services/Test/ft/MapServer&quot;);</span><br><span class="line">                map.addLayer(layer);</span><br><span class="line">                //创建几何服务对象</span><br><span class="line">                var geometryServices = new GeometryService(&quot;http://localhost:6080/arcgis/rest/services/Utilities/Geometry/GeometryServer&quot;);</span><br><span class="line">                //一个标志位，用于记录是绘制第几个参数</span><br><span class="line">                //1代表第一个参数</span><br><span class="line">                //2代表第二个参数</span><br><span class="line">                var flag;</span><br><span class="line">                //第一个参数  注意第一个参数是多个形状</span><br><span class="line">                var geometries=[];</span><br><span class="line">                //第二个参数  注意第二个参数是一个形状</span><br><span class="line">                var paramGeometry;</span><br><span class="line">                //使用toolbar上的绘图工具</span><br><span class="line">                var toolBar = new Draw(map);</span><br><span class="line">                </span><br><span class="line">                //线符号</span><br><span class="line">                lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //第一个参数的面符号</span><br><span class="line">                polygonSymbol1 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([255, 0, 0, 0.25]));</span><br><span class="line">                //第二个参数的面符号</span><br><span class="line">                polygonSymbol2 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([0, 255, 0, 0.25]));</span><br><span class="line">                //求交之后的面符号</span><br><span class="line">                polygonSymbol3 = new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol, new Color([0, 0, 255, 0.25]));</span><br><span class="line">                //给绘制polygon的按钮绑定事件</span><br><span class="line">                query(&quot;.pbtn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                    var value=this.innerHTML;</span><br><span class="line">                    switch(value)&#123;</span><br><span class="line">                        case &quot;第一个参数&quot;:&#123;</span><br><span class="line">                            flag=1;</span><br><span class="line">                            break;</span><br><span class="line">                            </span><br><span class="line">                        &#125;</span><br><span class="line">                        case &quot;第二个参数&quot;:&#123;</span><br><span class="line">                            flag=2;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;   </span><br><span class="line">                    &#125;</span><br><span class="line">                    //激活绘制多边形</span><br><span class="line">                    toolBar.activate(Draw.POLYGON, &#123;</span><br><span class="line">                        showTooltips:true</span><br><span class="line">                    &#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;)</span><br><span class="line">                //绘图结束绑定事件</span><br><span class="line">                on(toolBar,&quot;draw-end&quot;,function(result)&#123;</span><br><span class="line">                    //获得面形状</span><br><span class="line">                    var geometry=result.geometry;</span><br><span class="line">                    //创建Graphic</span><br><span class="line">                    var graphicpoint;</span><br><span class="line"></span><br><span class="line">                    //很重要！！！在这里构建参数对象</span><br><span class="line">                    if(flag==1)</span><br><span class="line">                    &#123;</span><br><span class="line">                        //创建Graphic</span><br><span class="line">                        graphicpoint = new Graphic(geometry, polygonSymbol1);</span><br><span class="line">                        geometries.push(geometry)</span><br><span class="line">                    &#125;</span><br><span class="line">                    else if(flag==2)</span><br><span class="line">                    &#123;</span><br><span class="line">                        //创建Graphic</span><br><span class="line">                        graphicpoint = new Graphic(geometry, polygonSymbol2);</span><br><span class="line">                        paramGeometry=geometry;</span><br><span class="line">                    &#125;   </span><br><span class="line">                    map.graphics.add(graphicpoint); </span><br><span class="line">                    //关闭绘图工具</span><br><span class="line">                    toolBar.deactivate();                   </span><br><span class="line">                &#125;)</span><br><span class="line">                //给求交按钮绑定事件</span><br><span class="line">                on(dom.byId(&quot;Btn&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //在这里在说一边，第一个参数是图形集合，第二个参数是一个图形</span><br><span class="line">                    geometryServices.intersect(geometries,paramGeometry,function(result)&#123;</span><br><span class="line">                        for(var idx in result)</span><br><span class="line">                        &#123;</span><br><span class="line">                            //创建Graphic</span><br><span class="line">                            var graphic=new Graphic(result[idx],polygonSymbol3)</span><br><span class="line">                            //将每一个结果都放在map中</span><br><span class="line">                            map.graphics.add(graphic)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">               </span><br><span class="line">            &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;mapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;button class=&quot;pbtn&quot; &gt;第一个参数&lt;/button&gt;</span><br><span class="line">    &lt;button class=&quot;pbtn&quot; &gt;第二个参数&lt;/button&gt;</span><br><span class="line">    &lt;input id=&quot;Btn&quot; type=&quot;button&quot; value=&quot;求交分析&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS22/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS21/">
                        ArcGIS API For Javascript之网络分析
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T09:27:59.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>在WebGIS中网络分析一直是比较常用的功能，比如：路径分析，服务点分析等等,在WebGIS中想要实现相应的功能需要将我们的服务发布为网络服务。</p>
<h3 id="路径分析"><a href="#路径分析" class="headerlink" title="路径分析"></a>路径分析</h3><p>在路径分析中，主要有两个比较关键的参数：</p>
<ul>
<li>停靠点</li>
<li>障碍点</li>
<li><p>总体来说，路径分析的步骤主要有以下几步：</p>
</li>
<li><p>发布网络分析服务</p>
</li>
<li>在Web端创建路径分析对象</li>
<li>构建路径分析参数。<br>（1）停靠点<br>（2）障碍点</li>
<li>获得结果，进行处理。</li>
</ul>
<p>####　代码实现<br>创建三个按钮（停靠点，障碍点，分析）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=&quot;Stop&quot; type=&quot;button&quot; value=&quot;停靠点&quot; /&gt;</span><br><span class="line">&lt;input id=&quot;barriers&quot; type=&quot;button&quot; value=&quot;障碍点&quot; /&gt;</span><br><span class="line">&lt;input id=&quot;Analyse&quot; type=&quot;button&quot; value=&quot;分析&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>添加地图（步骤省略）<br>创建路径分析对象，创建路径分析参数对象（注意：还缺少两个重要的参数，停靠点，障碍点）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//创建路径分析对象</span><br><span class="line">                var shortestAnalyst = new RouteTask(&quot;http://localhost:6080/arcgis/rest/services/Test/mynet/NAServer/Route&quot;);</span><br><span class="line">                //创建路径参数对象</span><br><span class="line">                var routeParas = new RouteParameters();</span><br><span class="line">                //障碍点，但是此时障碍点为空</span><br><span class="line">                routeParas.barriers = new FeatureSet();</span><br><span class="line">                //停靠点，但是此时停靠点为空</span><br><span class="line">                routeParas.stops = new FeatureSet();</span><br><span class="line">                //路径是否有方向</span><br><span class="line">                routeParas.returnDirections = false;</span><br><span class="line">                //是否返回路径，此处必须返回</span><br><span class="line">                routeParas.returnRoutes = true;</span><br><span class="line">                //空间参考</span><br><span class="line">                routeParas.outSpatialReference = map.SpatialReference;</span><br></pre></td></tr></table></figure></p>
<p>给停靠点按钮和障碍点按钮绑定点击事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//定义一个标志</span><br><span class="line">                //selectPointID=0什么都不做</span><br><span class="line">                //selectPointID=1说明是添加停靠点</span><br><span class="line">                //selectPointID=2说明是添加障碍点</span><br><span class="line">                var selectPointID;</span><br><span class="line">                //给停靠点按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;stop&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    selectPointID = 1;</span><br><span class="line">                &#125;)</span><br><span class="line">                //给障碍点按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;barriers&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    selectPointID = 2;</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<p>给地图绑定点击事件（为了获得点的坐标–&gt;构建停靠点或者障碍点）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">//定义停靠点的符号</span><br><span class="line">                var stopSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                stopSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                stopSymbol.setSize(8);</span><br><span class="line">                stopSymbol.setColor(new Color(&quot;#FFFFCC&quot;));</span><br><span class="line">                //定义障碍点的符号</span><br><span class="line">                var barrierSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                barrierSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                barrierSymbol.setSize(8);</span><br><span class="line">                barrierSymbol.setColor(new Color(&quot;#f1a340&quot;));</span><br><span class="line">                on(map, &quot;mouse-down&quot;, function(evt)&#123;</span><br><span class="line">                    //通过selectPointID判断是添加是停靠点还是障碍点</span><br><span class="line">                    switch (selectPointID) &#123;</span><br><span class="line">                        case 0:</span><br><span class="line">                            break;</span><br><span class="line">                        case 1:</span><br><span class="line">                            //获得停靠点的坐标</span><br><span class="line">                            var pointStop=evt.mapPoint;</span><br><span class="line">                            var gr=new Graphic(pointStop,stopSymbol);</span><br><span class="line">                            //构建停靠点的参数</span><br><span class="line">                            routeParas.stops.features.push(gr);</span><br><span class="line">                            break;</span><br><span class="line">                        case 2:</span><br><span class="line">                            //获得障碍点的坐标</span><br><span class="line">                            var pointBarrier=evt.mapPoint;</span><br><span class="line">                            var gr=new Graphic(pointBarrier,barrierSymbol);</span><br><span class="line">                            //构建障碍点的参数</span><br><span class="line">                            routeParas.barriers.features.push(gr);</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    //如果selectPointID不等于0，将点的坐标在地图上显示出来</span><br><span class="line">                    if (selectPointID != 0) &#123;</span><br><span class="line">                        addTextPoint(&quot;停靠点&quot;, pointStop, stopSymbol);</span><br><span class="line">                        addTextPoint(&quot;障碍点&quot;, pointBarrier, barrierSymbol);</span><br><span class="line">                        selectPointID = 0;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                //文本符号：文本信息，点坐标，符号</span><br><span class="line">                function addTextPoint(text,point,symbol) &#123;</span><br><span class="line">                    var textSymbol = new TextSymbol(text);</span><br><span class="line">                    textSymbol.setColor(new Color([128, 0, 0]));              </span><br><span class="line">                    var graphicText = Graphic(point, textSymbol);</span><br><span class="line">                    var graphicpoint = new Graphic(point, symbol);</span><br><span class="line">                    //用默认的图层添加</span><br><span class="line">                    map.graphics.add(graphicpoint);</span><br><span class="line">                    //用默认的图层添加</span><br><span class="line">                    map.graphics.add(graphicText);</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure></p>
<p>给分析按钮绑定点击事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//给分析按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;analyse&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //如果障碍点或者停靠点的个数有一个为0，提示用户参数输入不对</span><br><span class="line">                    if  (routeParas.stops.features.length  ==  0  || routeParas.barriers.features.length==0)</span><br><span class="line">                    &#123;</span><br><span class="line">                        alert(&quot;输入参数不全，无法分析&quot;);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    //执行路径分析函数</span><br><span class="line">                    shortestAnalyst.solve(routeParas, showRoute)</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<p>获得结果，处理路径分析返回的结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//处理路径分析返回的结果。</span><br><span class="line">                function showRoute(solveResult) &#123;</span><br><span class="line">                    //路径分析的结果</span><br><span class="line">                    var routeResults = solveResult.routeResults;</span><br><span class="line">                    //路径分析的长度</span><br><span class="line">                    var res = routeResults.length;</span><br><span class="line">                    //路径的符号</span><br><span class="line">                    routeSymbol  = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                    if (res &gt; 0) &#123;</span><br><span class="line">                        for (var i = 0; i &lt; res; i++) &#123;</span><br><span class="line">                            var graphicroute = routeResults[i];</span><br><span class="line">                            var graphic = graphicroute.route;</span><br><span class="line">                            graphic.setSymbol(routeSymbol);</span><br><span class="line">                            map.graphics.add(graphic);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        alert(&quot;没有返回结果&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h4><p>添加停靠点<br><img src="/2019/08/06/ArcGIS-API-for-JS21/01.png" alt="01.png"><br>添加障碍点<br><img src="/2019/08/06/ArcGIS-API-for-JS21/02.png" alt="02.png"><br>分析获得结果<br><img src="/2019/08/06/ArcGIS-API-for-JS21/03.png" alt="03.png"></p>
<h4 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;Geometric _Network&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:600px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/on&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/tasks/RouteTask&quot;,</span><br><span class="line">            &quot;esri/tasks/FeatureSet&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/TextSymbol&quot;,</span><br><span class="line">            &quot;esri/toolbars/draw&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;esri/tasks/RouteParameters&quot;,</span><br><span class="line">            &quot;dojo/colors&quot;,</span><br><span class="line">            &quot;esri/graphic&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;],</span><br><span class="line">            function (Map,on,dom,</span><br><span class="line">                ArcGISDynamicMapServiceLayer,</span><br><span class="line">                RouteTask,</span><br><span class="line">                FeatureSet,</span><br><span class="line">                SimpleMarkerSymbol,</span><br><span class="line">                TextSymbol,</span><br><span class="line">                Draw,</span><br><span class="line">                SimpleLineSymbol,</span><br><span class="line">                RouteParameters,</span><br><span class="line">                Color,</span><br><span class="line">                Graphic</span><br><span class="line">                ) &#123;</span><br><span class="line">                var map = new Map(&quot;MyMapDiv&quot;);</span><br><span class="line">                var layer = new ArcGISDynamicMapServiceLayer</span><br><span class="line">                (&quot;http://localhost:6080/arcgis/rest/services/Test/mynet/MapServer&quot;);</span><br><span class="line">                map.addLayer(layer)</span><br><span class="line">                //创建路径分析对象</span><br><span class="line">                var shortestAnalyst = new RouteTask(&quot;http://localhost:6080/arcgis/rest/services/Test/mynet/NAServer/Route&quot;);</span><br><span class="line">                //创建路径参数对象</span><br><span class="line">                var routeParas = new RouteParameters();</span><br><span class="line">                //障碍点，但是此时障碍点为空</span><br><span class="line">                routeParas.barriers = new FeatureSet();</span><br><span class="line">                //停靠点，但是此时停靠点为空</span><br><span class="line">                routeParas.stops = new FeatureSet();</span><br><span class="line">                //路径是否有方向</span><br><span class="line">                routeParas.returnDirections = false;</span><br><span class="line">                //是否返回路径，此处必须返回</span><br><span class="line">                routeParas.returnRoutes = true;</span><br><span class="line">                //空间参考</span><br><span class="line">                routeParas.outSpatialReference = map.SpatialReference;</span><br><span class="line">                //定义一个标志</span><br><span class="line">                //selectPointID=0什么都不做</span><br><span class="line">                //selectPointID=1说明是添加停靠点</span><br><span class="line">                //selectPointID=2说明是添加障碍点</span><br><span class="line">                var selectPointID;</span><br><span class="line">                //给停靠点按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;stop&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    selectPointID = 1;</span><br><span class="line">                &#125;)</span><br><span class="line">                //给障碍点按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;barriers&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    selectPointID = 2;</span><br><span class="line">                &#125;)</span><br><span class="line">                //定义停靠点的符号</span><br><span class="line">                var stopSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                stopSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                stopSymbol.setSize(8);</span><br><span class="line">                stopSymbol.setColor(new Color(&quot;#FFFFCC&quot;));</span><br><span class="line">                //定义障碍点的符号</span><br><span class="line">                var barrierSymbol = new SimpleMarkerSymbol();</span><br><span class="line">                barrierSymbol.style = SimpleMarkerSymbol.STYLE_CIRCLE;</span><br><span class="line">                barrierSymbol.setSize(8);</span><br><span class="line">                barrierSymbol.setColor(new Color(&quot;#f1a340&quot;));</span><br><span class="line">                on(map, &quot;mouse-down&quot;, function(evt)&#123;</span><br><span class="line">                    //通过selectPointID判断是添加是停靠点还是障碍点</span><br><span class="line">                    switch (selectPointID) &#123;</span><br><span class="line">                        case 0:</span><br><span class="line">                            break;</span><br><span class="line">                        case 1:</span><br><span class="line">                            //获得停靠点的坐标</span><br><span class="line">                            var pointStop=evt.mapPoint;</span><br><span class="line">                            var gr=new Graphic(pointStop,stopSymbol);</span><br><span class="line">                            //构建停靠点的参数</span><br><span class="line">                            routeParas.stops.features.push(gr);</span><br><span class="line">                            break;</span><br><span class="line">                        case 2:</span><br><span class="line">                            //获得障碍点的坐标</span><br><span class="line">                            var pointBarrier=evt.mapPoint;</span><br><span class="line">                            var gr=new Graphic(pointBarrier,barrierSymbol);</span><br><span class="line">                            //构建障碍点的参数</span><br><span class="line">                            routeParas.barriers.features.push(gr);</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    //如果selectPointID不等于0，将点的坐标在地图上显示出来</span><br><span class="line">                    if (selectPointID != 0) &#123;</span><br><span class="line">                        addTextPoint(&quot;停靠点&quot;, pointStop, stopSymbol);</span><br><span class="line">                        addTextPoint(&quot;障碍点&quot;, pointBarrier, barrierSymbol);</span><br><span class="line">                        selectPointID = 0;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                //文本符号：文本信息，点坐标，符号</span><br><span class="line">                function addTextPoint(text,point,symbol) &#123;</span><br><span class="line">                    var textSymbol = new TextSymbol(text);</span><br><span class="line">                    textSymbol.setColor(new Color([128, 0, 0]));              </span><br><span class="line">                    var graphicText = Graphic(point, textSymbol);</span><br><span class="line">                    var graphicpoint = new Graphic(point, symbol);</span><br><span class="line">                    //用默认的图层添加</span><br><span class="line">                    map.graphics.add(graphicpoint);</span><br><span class="line">                    map.graphics.add(graphicText);</span><br><span class="line">                &#125;</span><br><span class="line">                //给分析按钮添加点击事件</span><br><span class="line">                on(dom.byId(&quot;analyse&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //如果障碍点或者停靠点的个数有一个为0，提示用户参数输入不对</span><br><span class="line">                    if  (routeParas.stops.features.length  ==  0  || routeParas.barriers.features.length==0)</span><br><span class="line">                    &#123;</span><br><span class="line">                        alert(&quot;输入参数不全，无法分析&quot;);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    //执行路径分析函数</span><br><span class="line">                    shortestAnalyst.solve(routeParas, showRoute)</span><br><span class="line">                &#125;)</span><br><span class="line">                //处理路径分析返回的结果。</span><br><span class="line">                function showRoute(solveResult) &#123;</span><br><span class="line">                    //路径分析的结果</span><br><span class="line">                    var routeResults = solveResult.routeResults;</span><br><span class="line">                    //路径分析的长度</span><br><span class="line">                    var res = routeResults.length;</span><br><span class="line">                    //路径的符号</span><br><span class="line">                    routeSymbol  = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                    if (res &gt; 0) &#123;</span><br><span class="line">                        for (var i = 0; i &lt; res; i++) &#123;</span><br><span class="line">                            var graphicroute = routeResults[i];</span><br><span class="line">                            var graphic = graphicroute.route;</span><br><span class="line">                            graphic.setSymbol(routeSymbol);</span><br><span class="line">                            map.graphics.add(graphic);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        alert(&quot;没有返回结果&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;               </span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;MyMapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;input id=&quot;stop&quot; type=&quot;button&quot; value=&quot;停靠点&quot; /&gt;</span><br><span class="line">    &lt;input id=&quot;barriers&quot; type=&quot;button&quot; value=&quot;障碍点&quot; /&gt;</span><br><span class="line">    &lt;input id=&quot;analyse&quot; type=&quot;button&quot; value=&quot;分析&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS21/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS20/">
                        ArcGIS API For Javascript之编辑服务器端图层
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T09:19:00.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>在现实需求中，我们不仅仅需要编辑客户端图层，也有可能去编辑服务器端图层，要想编辑服务器端的图层，必须要将地图发布为：要素服务</p>
<h3 id="需求（服务器端图层编辑）"><a href="#需求（服务器端图层编辑）" class="headerlink" title="需求（服务器端图层编辑）"></a>需求（服务器端图层编辑）</h3><p>关于服务器端图层的操作,基本就是增删改查操作，要素服务的查询前面已经介绍过，在此篇博客中主要记录一下关于要素服务的增删改操作,在ArcGIS API for JS中给我们提供了三个类用于要素的增Add,删Delete,改Update,接下来就用这三个类来实现我们的功能。</p>
<ul>
<li>我们操作的是要素服务的sushelou图层</li>
<li>我们的服务：</li>
</ul>
<p><img src="/2019/08/06/ArcGIS-API-for-JS20/01.png" alt="01.png"><br>注意：宿舍楼图层编号为1</p>
<p>图层的属性信息<br><img src="/2019/08/06/ArcGIS-API-for-JS20/02.png" alt="02.png"></p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>首先在页面添加三个按钮(用于实现用户的增删改操作)</p>
<p><button class="btn">添加要素</button></p>
<p><button class="btn">删除要素</button></p>
<p><button class="btn">修改要素</button></p>
<p><button class="btn">查询要素</button><br>添加地图（省略）<br>创建通用的对象，例如Draw<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//用于操作的要素图层，注意我们是操作的宿舍楼图层</span><br><span class="line">var featureLayer = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/ft/FeatureServer/1&quot;,</span><br><span class="line">                    &#123;</span><br><span class="line">                            mode:FeatureLayer.MODE_SNAPSHOT,</span><br><span class="line">                            outFields: [&quot;*&quot;]</span><br><span class="line">                    &#125;);</span><br><span class="line">                    //在添加要素时，利用Draw工具获得geometry对象</span><br><span class="line">                    var d = new Draw(map, &#123; showTooltips: true &#125;);</span><br><span class="line">                    //要操作的graphic</span><br><span class="line">                    var g;</span><br></pre></td></tr></table></figure></p>
<p>给相应的按钮添加绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">query(&quot;button&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                        //获得按钮的文本</span><br><span class="line">                        var value=this.innerHTML; </span><br><span class="line">                        //根据文本绑定不同的事件</span><br><span class="line">                        switch(value)&#123;</span><br><span class="line">                            case &quot;添加要素&quot;:</span><br><span class="line">                                d.activate(Draw.POLYGON);</span><br><span class="line">                                break;</span><br><span class="line">                            case &quot;删除要素&quot;:</span><br><span class="line">                                //创建Graphic对象，删除OBJECTID为34的元素，</span><br><span class="line">                                //因为OBJECTID是主键，所以只需要指定主键即可</span><br><span class="line">                                g=new Graphic(&quot;&quot;,&quot;&quot;,&#123;</span><br><span class="line">                                    &quot;OBJECTID&quot;:34</span><br><span class="line">                                &#125;);</span><br><span class="line">                                //创建删除对象</span><br><span class="line">                                var de=new Delete(&#123;</span><br><span class="line">                                    &quot;featureLayer&quot;:featureLayer,</span><br><span class="line">                                    &quot;deletedGraphics&quot;:[g]</span><br><span class="line">                                &#125;);</span><br><span class="line">                                //执行删除结果</span><br><span class="line">                                de.performRedo();</span><br><span class="line">                                //刷新图层</span><br><span class="line">                                layer.refresh();</span><br><span class="line">                                break;</span><br><span class="line">                            case &quot;修改要素&quot;:</span><br><span class="line">                                //用于修改要素的函数,查询更新为36的要素</span><br><span class="line">                                updateFeature(36);</span><br><span class="line">                                break;                          </span><br><span class="line">                            case &quot;查询要素&quot;:</span><br><span class="line">                                //用于查询要素的函数，查询主键为36的要素</span><br><span class="line">                                searchFeather(36);</span><br><span class="line">                                break;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br></pre></td></tr></table></figure></p>
<p>如果是添加操作（利用draw添加geometry属性）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//当画图完毕时，添加要素</span><br><span class="line">                    on(d, &quot;draw-complete&quot;, function (result) &#123;</span><br><span class="line">                        //要素只赋予了geometry，属性信息为空</span><br><span class="line">                        var graphic = new Graphic(result.geometry, null,&#123;&#125;);</span><br><span class="line">                        var add=new Add(&#123;</span><br><span class="line">                            &quot;featureLayer&quot;:featureLayer,//给哪一个要素图层添加要素</span><br><span class="line">                            &quot;addedGraphics&quot;:[graphic]//用于添加的要素</span><br><span class="line">                        &#125;)</span><br><span class="line">                        //执行添加函数</span><br><span class="line">                        add.performRedo();</span><br><span class="line">                        //刷新视图</span><br><span class="line">                        layer.refresh();</span><br><span class="line">                        //关闭绘图对象</span><br><span class="line">                        d.deactivate();</span><br><span class="line">                    &#125;);</span><br></pre></td></tr></table></figure></p>
<p>如果是查询操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//根据id查询要素</span><br><span class="line">            function searchFeather(id,callback)&#123;</span><br><span class="line">                        //得到要素图层的主键属性</span><br><span class="line">                        var idProperty = featureLayer.objectIdField;</span><br><span class="line">                        //定义查询参数</span><br><span class="line">                        var query = new Query();</span><br><span class="line">                        //是否返回几何形状</span><br><span class="line">                        query.returnGeometry = false;</span><br><span class="line">                        //图层的主键名称（根据自己要求修改）</span><br><span class="line">                        query.objectIds = [id];</span><br><span class="line">                        //查询条件1=1意思是：只根据主键查询，忽略where子句</span><br><span class="line">                        query.where = &quot;1=1&quot;;</span><br><span class="line">                        //进行查询</span><br><span class="line">                        featureLayer.selectFeatures(query, FeatureLayer.SELECTION_NEW,function(result)&#123;</span><br><span class="line">                            //如果callback不存在，说明仅仅是查询操作</span><br><span class="line">                            if(!callback)&#123;</span><br><span class="line">                                //因为我们根据主键查询，一定只有一个元素</span><br><span class="line">                                var graphic=result[0];</span><br><span class="line">                                //获得属性</span><br><span class="line">                                var attributes=graphic.attributes;</span><br><span class="line">                                //得到该属性信息转换成字符串</span><br><span class="line">                                var result=jsonUtil.stringify(attributes)</span><br><span class="line">                                //将结果弹出一下</span><br><span class="line">                                alert(result);</span><br><span class="line">                            &#125;else//如果callback存在，说明是更新操作</span><br><span class="line">                            &#123;</span><br><span class="line">                                callback(result);</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure></p>
<p>如果是更新操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//根据id修改要素</span><br><span class="line">                    function updateFeature(id)&#123;</span><br><span class="line">                        //注意:（第二个参数）这里传入一个回调函数，用于处理查询出来的数据</span><br><span class="line">                        searchFeather(id,function(result)&#123;</span><br><span class="line">                                //获得旧的要素</span><br><span class="line">                                var oldgraphic=result[0];</span><br><span class="line">                                //新的要素</span><br><span class="line">                                var newgraphic=new Graphic(oldgraphic.toJson());</span><br><span class="line">                                //将alias属性修改为:修改后的C区</span><br><span class="line">                                newgraphic.attributes.alias=&quot;修改后的C区&quot;;</span><br><span class="line">                                //创建更新对象</span><br><span class="line">                                var update=new Update(&#123;</span><br><span class="line">                                    &quot;featureLayer&quot;:featureLayer,</span><br><span class="line">                                    &quot;postUpdatedGraphics&quot;:[newgraphic],//修改之后的要素</span><br><span class="line">                                    &quot;preUpdatedGraphics&quot;:[oldgraphic]//修改之前的要素</span><br><span class="line">                                &#125;)</span><br><span class="line">                                //执行刷新操作</span><br><span class="line">                                update.performRedo();</span><br><span class="line">                                //刷新视图</span><br><span class="line">                                layer.refresh();</span><br><span class="line">                                alert(&quot;修改成功&quot;);</span><br><span class="line">                                </span><br><span class="line">                        &#125;)</span><br><span class="line">                        </span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br><span class="line">    &lt;title&gt;WebGIS&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">        &quot;dojo/on&quot;,</span><br><span class="line">        &quot;dojo/query&quot;,</span><br><span class="line">        &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">        &quot;esri/toolbars/draw&quot;,</span><br><span class="line">        &quot;esri/layers/FeatureLayer&quot;,</span><br><span class="line">        &quot;esri/graphic&quot;, &quot;esri/dijit/editing/Add&quot;,</span><br><span class="line">        &quot;esri/dijit/editing/Delete&quot;,&quot;esri/dijit/editing/Update&quot;,&quot;esri/tasks/query&quot;,&quot;dojo/json&quot;,</span><br><span class="line">        &quot;dojo/domReady!&quot;],</span><br><span class="line">                function (Map,on,query, ArcGISDynamicMapServiceLayer, Draw,FeatureLayer,Graphic,Add,Delete,Update,Query,jsonUtil) &#123;</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line">                    var map = new esri.Map(&quot;MyMapDiv&quot;);</span><br><span class="line">                    var layer = new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/ft/MapServer&quot;);</span><br><span class="line">                    map.addLayer(layer);</span><br><span class="line">                    //用于操作的要素图层，注意我们是操作的宿舍楼图层</span><br><span class="line">                    var featureLayer = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/ft/FeatureServer/1&quot;,</span><br><span class="line">                         &#123;</span><br><span class="line">                            mode:FeatureLayer.MODE_SNAPSHOT,</span><br><span class="line">                            outFields: [&quot;*&quot;]</span><br><span class="line">                         &#125;);</span><br><span class="line">                    //在添加要素时，利用Draw工具获得geometry对象</span><br><span class="line">                    var d = new Draw(map, &#123; showTooltips: true &#125;);</span><br><span class="line">                    //要操作的graphic</span><br><span class="line">                    var g;</span><br><span class="line">                    query(&quot;button&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                        var value=this.innerHTML;</span><br><span class="line">                        switch(value)&#123;</span><br><span class="line">                            case &quot;添加要素&quot;:</span><br><span class="line">                                d.activate(Draw.POLYGON);</span><br><span class="line">                                break;</span><br><span class="line">                            case &quot;删除要素&quot;:</span><br><span class="line">                                //创建Graphic对象，删除OBJECTID为34的元素，</span><br><span class="line">                                //因为OBJECTID是主键，所以只需要指定主键即可</span><br><span class="line">                                g=new Graphic(&quot;&quot;,&quot;&quot;,&#123;</span><br><span class="line">                                    &quot;OBJECTID&quot;:34</span><br><span class="line">                                &#125;);</span><br><span class="line">                                //创建删除对象</span><br><span class="line">                                var de=new Delete(&#123;</span><br><span class="line">                                    &quot;featureLayer&quot;:featureLayer,</span><br><span class="line">                                    &quot;deletedGraphics&quot;:[g]</span><br><span class="line">                                &#125;);</span><br><span class="line">                                //执行删除结果</span><br><span class="line">                                de.performRedo();</span><br><span class="line">                                //刷新图层</span><br><span class="line">                                layer.refresh();</span><br><span class="line">                                break;</span><br><span class="line">                            case &quot;修改要素&quot;:</span><br><span class="line">                                //用于修改要素的函数,查询更新为36的要素</span><br><span class="line">                                updateFeature(1);</span><br><span class="line">                                break;                          </span><br><span class="line">                            case &quot;查询要素&quot;:</span><br><span class="line">                                //用于查询要素的函数，查询主键为36的要素</span><br><span class="line">                                searchFeather(1);</span><br><span class="line">                                break;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    //当画图完毕时，添加要素</span><br><span class="line">                    on(d, &quot;draw-complete&quot;, function (result) &#123;</span><br><span class="line">                        //要素只赋予了geometry，属性信息为空</span><br><span class="line">                        var graphic = new Graphic(result.geometry, null,&#123;&#125;);</span><br><span class="line">                        var add=new Add(&#123;</span><br><span class="line">                            &quot;featureLayer&quot;:featureLayer,//给哪一个要素图层添加要素</span><br><span class="line">                            &quot;addedGraphics&quot;:[graphic]//用于添加的要素</span><br><span class="line">                        &#125;)</span><br><span class="line">                        //执行添加函数</span><br><span class="line">                        add.performRedo();</span><br><span class="line">                        //刷新视图</span><br><span class="line">                        layer.refresh();</span><br><span class="line">                        //关闭绘图对象</span><br><span class="line">                        d.deactivate();</span><br><span class="line">                    &#125;);</span><br><span class="line">                    //根据id修改要素</span><br><span class="line">                    function updateFeature(id)&#123;</span><br><span class="line">                        //注意:（第二个参数）这里传入一个回调函数，用于处理查询出来的数据</span><br><span class="line">                        searchFeather(id,function(result)&#123;</span><br><span class="line">                                //获得旧的要素</span><br><span class="line">                                var oldgraphic=result[0];</span><br><span class="line">                                //新的要素</span><br><span class="line">                                var newgraphic=new Graphic(oldgraphic.toJson());</span><br><span class="line">                                //将alias属性修改为:修改后的A区宿舍</span><br><span class="line">                                newgraphic.attributes.alias=&quot;修改后的A区宿舍&quot;;</span><br><span class="line">                                //创建更新对象</span><br><span class="line">                                var update=new Update(&#123;</span><br><span class="line">                                    &quot;featureLayer&quot;:featureLayer,</span><br><span class="line">                                    &quot;postUpdatedGraphics&quot;:[newgraphic],//修改之后的要素</span><br><span class="line">                                    &quot;preUpdatedGraphics&quot;:[oldgraphic]//修改之前的要素</span><br><span class="line">                                &#125;)</span><br><span class="line">                                //执行刷新操作</span><br><span class="line">                                update.performRedo();</span><br><span class="line">                                //刷新视图</span><br><span class="line">                                layer.refresh();</span><br><span class="line">                                alert(&quot;修改成功&quot;);</span><br><span class="line">                                </span><br><span class="line">                        &#125;)</span><br><span class="line">                        </span><br><span class="line">                    &#125;</span><br><span class="line">                    //根据id查询要素</span><br><span class="line">                    function searchFeather(id,callback)&#123;</span><br><span class="line">                        //得到要素图层的主键属性</span><br><span class="line">                        var idProperty = featureLayer.objectIdField;</span><br><span class="line">                        //定义查询参数</span><br><span class="line">                        var query = new Query();</span><br><span class="line">                        //是否返回几何形状</span><br><span class="line">                        query.returnGeometry = false;</span><br><span class="line">                        //图层的主键名称（根据自己要求修改）</span><br><span class="line">                        query.objectIds = [id];</span><br><span class="line">                        //查询条件1=1意思是：只根据主键查询，忽略where子句</span><br><span class="line">                        query.where = &quot;1=1&quot;;</span><br><span class="line">                        //进行查询</span><br><span class="line">                        featureLayer.selectFeatures(query, FeatureLayer.SELECTION_NEW,function(result)&#123;</span><br><span class="line">                            //如果callback不存在，说明仅仅是查询操作</span><br><span class="line">                            if(!callback)&#123;</span><br><span class="line">                                //因为我们根据主键查询，一定只有一个元素</span><br><span class="line">                                var graphic=result[0];</span><br><span class="line">                                //获得属性</span><br><span class="line">                                var attributes=graphic.attributes;</span><br><span class="line">                                //得到该属性信息转换成字符串</span><br><span class="line">                                var result=jsonUtil.stringify(attributes)</span><br><span class="line">                                //将结果弹出一下</span><br><span class="line">                                alert(result);</span><br><span class="line">                            &#125;else//如果callback存在，说明是更新操作</span><br><span class="line">                            &#123;</span><br><span class="line">                                callback(result);</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;MyMapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;button class=&quot;btn&quot;&gt;添加要素&lt;/button&gt;</span><br><span class="line">&lt;button class=&quot;btn&quot;&gt;删除要素&lt;/button&gt;</span><br><span class="line">&lt;button class=&quot;btn&quot;&gt;修改要素&lt;/button&gt;</span><br><span class="line">&lt;button class=&quot;btn&quot;&gt;查询要素&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS20/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS19/">
                        ArcGIS API For Javacsript编辑客户端图形
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T09:07:56.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>在ArcGIS API当中，提供了一个工具叫做Edit，我们利用Edit可以交互的编辑客户端图形Graphic，这个功能在我们实际开发过程中非常有用，可以交互编辑已经存在的Graphic以达到我们的目的，Edit工具可以从以下方面编辑客户端图形：</p>
<ul>
<li>移动客户端图形</li>
<li>编辑结点（增加结点，删除结点）</li>
<li>拉伸客户端图形（是否保持长宽比例）</li>
<li>旋转客户端图形</li>
</ul>
<h3 id="Edit工具的使用"><a href="#Edit工具的使用" class="headerlink" title="Edit工具的使用"></a>Edit工具的使用</h3><p>使用Edit工具很简单，只需要以下几步即可：</p>
<ul>
<li>给地图添加Graphic，为了下面Edit交互操作做准备</li>
<li>创建Edit对象</li>
<li>激活Edit工具，此时需要制定Edit的一些参数</li>
<li>操作完Graphic将Edit工具关闭</li>
</ul>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>添加地图（省略）<br>定义Edit对象，和graphic对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//声明一个客户端图形（为了以后的编辑）</span><br><span class="line">var graphic</span><br><span class="line">//定义一个Edit对象</span><br><span class="line">var edit = new Edit(map);</span><br></pre></td></tr></table></figure></p>
<p>首先创建几个按钮（用户实现相应的功能）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;button&quot;  id=&quot;add&quot; value=&quot;添加客户端图形&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;移动客户端图形&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;拉伸客户端图形&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;旋转客户端图形&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;编辑结点&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>给添加客户端图形按钮添加绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">on(dom.byId(&quot;add&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol=new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //定义面符号</span><br><span class="line">                var fill=SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol,  new Color([255, 0, 0]));</span><br><span class="line">                //点的坐标对</span><br><span class="line">                var ring=[];</span><br><span class="line">                ring[0]=[</span><br><span class="line">                    [510275, 3986100],</span><br><span class="line">                    [510508, 3986162],</span><br><span class="line">                    [510596, 3986032],</span><br><span class="line">                    [510271, 3985847],</span><br><span class="line">                    [510275, 3986100]</span><br><span class="line">                ];</span><br><span class="line">                var geometry=new Polygon(&#123;</span><br><span class="line">                    &quot;rings&quot;:ring,</span><br><span class="line">                    &quot;spatialReference&quot;:map.spatialReference</span><br><span class="line">                &#125;);</span><br><span class="line">                graphic=new Graphic(geometry,fill);</span><br><span class="line">                map.graphics.add(graphic);</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
<p>给剩余四个按钮添加绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//给剩余四个按钮绑定事件</span><br><span class="line">            query(&quot;.btn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                var value=event.currentTarget.defaultValue;</span><br><span class="line">                switch(value)&#123;</span><br><span class="line">                    case &quot;移动客户端图形&quot;:</span><br><span class="line">                        //激活Edit工具（移动）</span><br><span class="line">                        edit.activate(Edit.MOVE,graphic);</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;拉伸客户端图形&quot;:</span><br><span class="line">                        //构建Edit参数 注：拉伸的时候，可以指定是否保持长宽比例</span><br><span class="line">                        var options = &#123;</span><br><span class="line">                            uniformScaling:true</span><br><span class="line">                        &#125;;</span><br><span class="line">                        //激活Edit工具（拉伸客户端图形）</span><br><span class="line">                        edit.activate(Edit.SCALE,graphic,options)</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;旋转客户端图形&quot;:</span><br><span class="line">                        //激活Edit工具（旋转客户端图形）</span><br><span class="line">                        edit.activate(Edit.ROTATE,graphic)</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;编辑结点&quot;:</span><br><span class="line">                        //构建Edit参数 注：编辑折点的时候，要指定是否能添加或者删除结点。</span><br><span class="line">                        var options = &#123;</span><br><span class="line">                            allowAddVertices:true,//能添加结点</span><br><span class="line">                            allowDeleteVertices: true,//能删除结点</span><br><span class="line">                        &#125;;</span><br><span class="line">                        edit.activate(Edit.EDIT_VERTICES, graphic, options);</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
<p>关闭Edit工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//用完Edit工具，将工具关闭，点击地图（没有点击到Graphic时结束）</span><br><span class="line">            map.on(&quot;click&quot;, function () &#123;</span><br><span class="line">                edit.deactivate();</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p><img src="/2019/08/06/ArcGIS-API-for-JS19/1.png" alt="1.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS19/2.png" alt="2.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS19/3.png" alt="3.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS19/4.png" alt="4.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS19/5.png" alt="5.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS19/6.png" alt="6.png"></p>
<h4 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Graphic&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .MapClass&#123;</span><br><span class="line">            width:100%;</span><br><span class="line">            height:500px;</span><br><span class="line">            border:1px solid #000;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        require([&quot;esri/map&quot;,&quot;dojo/dom&quot;,&quot;dojo/on&quot;,&quot;esri/toolbars/edit&quot;,&quot;esri/geometry/Polygon&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;, &quot;esri/graphic&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;, &quot;esri/symbols/SimpleFillSymbol&quot;,&quot;dojo/colors&quot;,&quot;dojo/query&quot;,</span><br><span class="line">             &quot;dojo/domReady!&quot;</span><br><span class="line">        ], function (</span><br><span class="line">                Map,dom,on, Edit,Polygon, ArcGISDynamicMapServiceLayer, Graphic,</span><br><span class="line">                SimpleLineSymbol, SimpleFillSymbol,Color,query</span><br><span class="line">        ) &#123;</span><br><span class="line">            var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">            var url = &quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer&quot;;</span><br><span class="line">            var layer = new ArcGISDynamicMapServiceLayer(url);</span><br><span class="line">            map.addLayer(layer);</span><br><span class="line">            //定义一个Edit对象</span><br><span class="line">            var edit = new Edit(map);</span><br><span class="line">            //定义一个graphic，为了后来的交互编辑</span><br><span class="line">            var graphic;</span><br><span class="line">            //给`添加客户端图形`按钮添加绑定事件</span><br><span class="line">            on(dom.byId(&quot;add&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol=new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new Color([255, 0, 0]), 3);</span><br><span class="line">                //定义面符号</span><br><span class="line">                var fill=SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, lineSymbol,  new Color([255, 0, 0]));</span><br><span class="line">                //点的坐标对</span><br><span class="line">                var ring=[];</span><br><span class="line">                ring[0]=[</span><br><span class="line">                    [510275, 3986100],</span><br><span class="line">                    [510508, 3986162],</span><br><span class="line">                    [510596, 3986032],</span><br><span class="line">                    [510271, 3985847],</span><br><span class="line">                    [510275, 3986100]</span><br><span class="line">                ];</span><br><span class="line">                var geometry=new Polygon(&#123;</span><br><span class="line">                    &quot;rings&quot;:ring,</span><br><span class="line">                    &quot;spatialReference&quot;:map.spatialReference</span><br><span class="line">                &#125;);</span><br><span class="line">                graphic=new Graphic(geometry,fill);</span><br><span class="line">                map.graphics.add(graphic);</span><br><span class="line">            &#125;)</span><br><span class="line">            //给按钮绑定事件</span><br><span class="line">            query(&quot;.btn&quot;).on(&quot;click&quot;,function(event)&#123;</span><br><span class="line">                var value=event.currentTarget.defaultValue;</span><br><span class="line">                switch(value)&#123;</span><br><span class="line">                    case &quot;移动客户端图形&quot;:</span><br><span class="line">                        //激活Edit工具（移动）</span><br><span class="line">                        edit.activate(Edit.MOVE,graphic);</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;拉伸客户端图形&quot;:</span><br><span class="line">                        //构建Edit参数 注：拉伸的时候，可以指定是否保持长宽比例</span><br><span class="line">                        var options = &#123;</span><br><span class="line">                            uniformScaling:true</span><br><span class="line">                        &#125;;</span><br><span class="line">                        //激活Edit工具（拉伸客户端图形）</span><br><span class="line">                        edit.activate(Edit.SCALE,graphic,options)</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;旋转客户端图形&quot;:</span><br><span class="line">                        //激活Edit工具（旋转客户端图形）</span><br><span class="line">                        edit.activate(Edit.ROTATE,graphic)</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;编辑结点&quot;:</span><br><span class="line">                        //构建Edit参数 注：编辑折点的时候，要指定是否能添加或者删除结点。</span><br><span class="line">                        var options = &#123;</span><br><span class="line">                            allowAddVertices:true,//能添加结点</span><br><span class="line">                            allowDeleteVertices: true,//能删除结点</span><br><span class="line">                        &#125;;</span><br><span class="line">                        edit.activate(Edit.EDIT_VERTICES, graphic, options);</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            //用完Edit工具，将工具关闭，点击地图（没有点击到Graphic时结束）</span><br><span class="line">            map.on(&quot;click&quot;, function () &#123;</span><br><span class="line">                edit.deactivate();</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;mapDiv&quot; class=&quot;MapClass&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot;  id=&quot;add&quot; value=&quot;添加客户端图形&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;移动客户端图形&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;拉伸客户端图形&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;旋转客户端图形&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; class=&quot;btn&quot; value=&quot;编辑结点&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS19/">
                        阅读更多
                    </a>
                </div>
            </div>
        
            <div class="post-item">
                <h1>
                    <a href="/2019/08/06/ArcGIS-API-for-JS18/">
                        ArcGIS API For Javascript之动态图层
                    </a>
                </h1>
                <div class="create">
                    <span>创建于</span>
                    
                        <time datetime="2019-08-06T08:42:34.000Z">
                            2019-08-06
                        </time>
                    
                    <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li></ul>
                </div>
                
                    <p>动态图层主要特点：</p>
<ul>
<li>改变地图服务的现有图层</li>
<li>动态图层适用于海量图层的情况</li>
<li>不需要将shp文件发布为服务，服务器可以直接读取shp文件在前端显示</li>
</ul>
<h3 id="调用动态图层"><a href="#调用动态图层" class="headerlink" title="调用动态图层"></a>调用动态图层</h3><p>在前面已经说过动态图层并不是一种新的服务类型，而是地图服务的一种扩展，因此我们不需要发布服务，只需要对地图服务添加动态图层功能即可。启用地图服务的步骤为：</p>
<ul>
<li>给相应的地图服务启用动态工作空间</li>
<li>选择服务器相应的硬盘地址并赋予其id</li>
<li>将相应位置注册到ArcGIS Server服务器（保证ArcGIS Server可以访问数据）</li>
<li>在Web端进行调用</li>
</ul>
<h4 id="启用动态图层"><a href="#启用动态图层" class="headerlink" title="启用动态图层"></a>启用动态图层</h4><p>我们打开Manager-&gt;登录，找到该服务，点击功能，选择允许每次请求修改图层顺序和符号-&gt;添加<br><img src="/2019/08/06/ArcGIS-API-for-JS18/01.png" alt="01.png"><br>硬盘上的数据<br><img src="/2019/08/06/ArcGIS-API-for-JS18/02.png" alt="02.png"><br>注:D:\myshp文件夹下面有一个shp文件：lunkuoxian.shp<br>因此我们选择工作空间类型为：shpfile文件夹，工作空间id在此处取名为my，硬盘路径：D：\myshp<br><img src="/2019/08/06/ArcGIS-API-for-JS18/03.png" alt="03.png"><br>点击确定，重新启动服务<br><img src="/2019/08/06/ArcGIS-API-for-JS18/04.png" alt="04.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS18/05.png" alt="05.png"><br>注册文件夹到服务器<br>点击站点-&gt;数据存储-&gt;注册文件夹（因为我们是文件夹，所以是注册文件夹，如果是数据库，那么就要注册数据库）<br><img src="/2019/08/06/ArcGIS-API-for-JS18/06.png" alt="06.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS18/07.png" alt="07.png"><br><img src="/2019/08/06/ArcGIS-API-for-JS18/08.png" alt="08.png"><br>在Services Directory 查看动态图层是否启用<br><img src="/2019/08/06/ArcGIS-API-for-JS18/09.png" alt="09.png"></p>
<h4 id="Web端调用"><a href="#Web端调用" class="headerlink" title="Web端调用"></a>Web端调用</h4><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>首先我们加载地图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,</span><br><span class="line">            &quot;dojo/on&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/layers/FeatureLayer&quot;,</span><br><span class="line">            &quot;esri/layers/TableDataSource&quot;,</span><br><span class="line">            &quot;esri/layers/LayerDataSource&quot;,</span><br><span class="line">            &quot;esri/renderers/SimpleRenderer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleMarkerSymbol&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;], function (</span><br><span class="line">                Map,dom,on, ArcGISDynamicMapServiceLayer, FeatureLayer, TableDataSource, LayerDataSource, SimpleRenderer, SimpleMarkerSymbol,SimpleLineSymbol) &#123;</span><br><span class="line">            var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">            var layer1 = new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services//Test/MyService/MapServer&quot;);</span><br><span class="line">            map.addLayer(layer1);</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure></p>
<p>添加一个按钮（用于添加动态图层）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=&quot;btn&quot;&gt;添加动态图层&lt;/button&gt;</span><br></pre></td></tr></table></figure></p>
<p>给按钮添加事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function(e)&#123;</span><br><span class="line">                //定义一个数据源</span><br><span class="line">                var dataSource = new TableDataSource();</span><br><span class="line">                //此处为我们设置的命名空间</span><br><span class="line">                dataSource.workspaceId = &quot;my&quot;;</span><br><span class="line">                //命名空间下面的shp</span><br><span class="line">                dataSource.dataSourceName = &quot;lunkuoxian.shp&quot;;</span><br><span class="line">                //定义一个图层数据源</span><br><span class="line">                var layerSource = new LayerDataSource();</span><br><span class="line">                //给图层数据源赋值</span><br><span class="line">                layerSource.dataSource = dataSource;</span><br><span class="line">                //定义一个要素图层:注意链接为动态图层的地址</span><br><span class="line">                var layer2 = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer/dynamicLayer&quot;, &#123;</span><br><span class="line">                    mode: FeatureLayer.MODE_ONDEMAND,</span><br><span class="line">                    outFields: [&quot;*&quot;],</span><br><span class="line">                    source: layerSource</span><br><span class="line">                &#125;);</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                var renderer = new esri.renderer.SimpleRenderer(lineSymbol);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                layer2.setRenderer(renderer);</span><br><span class="line">                layer2.refresh();</span><br><span class="line">                map.addLayer(layer2);</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<h5 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=&quot;en&quot;&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,</span><br><span class="line">            &quot;dojo/on&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/layers/FeatureLayer&quot;,</span><br><span class="line">            &quot;esri/layers/TableDataSource&quot;,</span><br><span class="line">            &quot;esri/layers/LayerDataSource&quot;,</span><br><span class="line">            &quot;esri/renderers/SimpleRenderer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;], function (</span><br><span class="line">                Map,dom,on, ArcGISDynamicMapServiceLayer, FeatureLayer, TableDataSource, LayerDataSource, SimpleRenderer,SimpleLineSymbol) &#123;</span><br><span class="line">            var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">            var layer1 = new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services//Test/MyService/MapServer&quot;);</span><br><span class="line">            map.addLayer(layer1);</span><br><span class="line"></span><br><span class="line">            on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function(e)&#123;</span><br><span class="line">                //定义一个数据源</span><br><span class="line">                var dataSource = new TableDataSource();</span><br><span class="line">                //此处为我们设置的命名空间</span><br><span class="line">                dataSource.workspaceId = &quot;my&quot;;</span><br><span class="line">                //命名空间下面的shp</span><br><span class="line">                dataSource.dataSourceName = &quot;lunkuoxian.shp&quot;;</span><br><span class="line">                //定义一个图层数据源</span><br><span class="line">                var layerSource = new LayerDataSource();</span><br><span class="line">                //给图层数据源赋值</span><br><span class="line">                layerSource.dataSource = dataSource;</span><br><span class="line">                //定义一个要素图层:注意链接为动态图层的地址</span><br><span class="line">                var layer2 = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer/dynamicLayer&quot;, &#123;</span><br><span class="line">                    mode: FeatureLayer.MODE_ONDEMAND,</span><br><span class="line">                    outFields: [&quot;*&quot;],</span><br><span class="line">                    source: layerSource</span><br><span class="line">                &#125;);</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                var renderer = new esri.renderer.SimpleRenderer(lineSymbol);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                layer2.setRenderer(renderer);</span><br><span class="line">                layer2.refresh();</span><br><span class="line">                map.addLayer(layer2);</span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;mapDiv&quot; style=&quot;height:600px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;添加动态图层&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>运行结果之后：<br><img src="/2019/08/06/ArcGIS-API-for-JS18/10.png" alt="10.png"></p>
<h3 id="动态图层的属性查询"><a href="#动态图层的属性查询" class="headerlink" title="动态图层的属性查询"></a>动态图层的属性查询</h3><p>在真实需求中,我们不仅仅是将shp在地图中显示那么简单，我们往往要查询该图层的属性信息,我们在前面代码的基础上添加上属性查询。</p>
<h4 id="方法1（通过click直接获取）"><a href="#方法1（通过click直接获取）" class="headerlink" title="方法1（通过click直接获取）"></a>方法1（通过click直接获取）</h4><h5 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h5><p>给要素图层添加点击事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">layer2.on(&quot;click&quot;, function(evt) &#123;</span><br><span class="line">                    //得到点击的graphics</span><br><span class="line">                    var graphic=evt.graphic;</span><br><span class="line">                    //得到该属性信息</span><br><span class="line">                    var attributes=graphic.attributes;</span><br><span class="line">                    //得到该属性信息转换成字符串</span><br><span class="line">                    var result=jsonUtil.stringify(attributes)</span><br><span class="line">                    //将结果弹出一下</span><br><span class="line">                    alert(result);</span><br><span class="line">                    //获得要素图层的主键名称</span><br><span class="line">                    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h5 id="全部代码"><a href="#全部代码" class="headerlink" title="全部代码"></a>全部代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=&quot;en&quot;&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,</span><br><span class="line">            &quot;dojo/on&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/layers/FeatureLayer&quot;,</span><br><span class="line">            &quot;esri/layers/TableDataSource&quot;,</span><br><span class="line">            &quot;esri/layers/LayerDataSource&quot;,</span><br><span class="line">            &quot;esri/renderers/SimpleRenderer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,&quot;dojo/json&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;], function (</span><br><span class="line">                Map,dom,on, ArcGISDynamicMapServiceLayer, FeatureLayer, TableDataSource, LayerDataSource, SimpleRenderer,SimpleLineSymbol,jsonUtil) &#123;</span><br><span class="line">            var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">            var layer1 = new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services//Test/MyService/MapServer&quot;);</span><br><span class="line">            map.addLayer(layer1);</span><br><span class="line"></span><br><span class="line">            on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function(e)&#123;</span><br><span class="line">                //定义一个数据源</span><br><span class="line">                var dataSource = new TableDataSource();</span><br><span class="line">                //此处为我们设置的命名空间</span><br><span class="line">                dataSource.workspaceId = &quot;my&quot;;</span><br><span class="line">                //命名空间下面的shp</span><br><span class="line">                dataSource.dataSourceName = &quot;lunkuoxian.shp&quot;;</span><br><span class="line">                //定义一个图层数据源</span><br><span class="line">                var layerSource = new LayerDataSource();</span><br><span class="line">                //给图层数据源赋值</span><br><span class="line">                layerSource.dataSource = dataSource;</span><br><span class="line">                //定义一个要素图层:注意链接为动态图层的地址</span><br><span class="line">                var layer2 = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer/dynamicLayer&quot;, &#123;</span><br><span class="line">                    mode: FeatureLayer.MODE_ONDEMAND,</span><br><span class="line">                    outFields: [&quot;*&quot;],</span><br><span class="line">                    source: layerSource</span><br><span class="line">                &#125;);</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                var renderer = new esri.renderer.SimpleRenderer(lineSymbol);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                layer2.setRenderer(renderer);</span><br><span class="line">                layer2.refresh();</span><br><span class="line">                map.addLayer(layer2);</span><br><span class="line">                layer2.on(&quot;click&quot;, function(evt) &#123;</span><br><span class="line">                    //得到点击的graphics</span><br><span class="line">                    var graphic=evt.graphic;</span><br><span class="line">                    //得到该属性信息</span><br><span class="line">                    var attributes=graphic.attributes;</span><br><span class="line">                    //得到该属性信息转换成字符串</span><br><span class="line">                    var result=jsonUtil.stringify(attributes)</span><br><span class="line">                    //将结果弹出一下</span><br><span class="line">                    alert(result);</span><br><span class="line">                    //获得要素图层的主键名称</span><br><span class="line"></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;mapDiv&quot; style=&quot;height:600px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;添加动态图层&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>运行结果:<br><img src="/2019/08/06/ArcGIS-API-for-JS18/11.png" alt="11.png"></p>
<h4 id="通过查询获得属性"><a href="#通过查询获得属性" class="headerlink" title="通过查询获得属性"></a>通过查询获得属性</h4><h5 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h5><p>定义一个按钮（用户获得属性）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=&quot;attr&quot;&gt;用户弹出属性&lt;/button&gt;</span><br></pre></td></tr></table></figure></p>
<p>给相应的按钮绑定事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">on(dom.byId(&quot;attr&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //得到要素图层的主键属性</span><br><span class="line">                    var idProperty = layer2.objectIdField;</span><br><span class="line">                    //定义查询参数</span><br><span class="line">                    var query = new Query();</span><br><span class="line">                    //是否返回几何形状</span><br><span class="line">                    query.returnGeometry = false;</span><br><span class="line">                    //图层的主键名称（根据自己要求修改）</span><br><span class="line">                    query.objectIds = [247];</span><br><span class="line">                    //查询条件1=1意思是：只根据主键查询，忽略where子句</span><br><span class="line">                    query.where = &quot;1=1&quot;;</span><br><span class="line">                    //进行查询</span><br><span class="line">                    layer2.selectFeatures(query, FeatureLayer.SELECTION_NEW,function(result)&#123;</span><br><span class="line">                        //因为我们根据主键查询，一定只有一个元素</span><br><span class="line">                        var graphic=result[0];</span><br><span class="line">                        //获得属性</span><br><span class="line">                        var attributes=graphic.attributes;</span><br><span class="line">                        //得到该属性信息转换成字符串</span><br><span class="line">                        var result=jsonUtil.stringify(attributes)</span><br><span class="line">                        //将结果弹出一下</span><br><span class="line">                        alert(result);</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure></p>
<h5 id="全部代码-1"><a href="#全部代码-1" class="headerlink" title="全部代码"></a>全部代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=&quot;en&quot;&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/dijit/themes/tundra/tundra.css&quot;/&gt;</span><br><span class="line">    &lt;link  rel=&quot;stylesheet&quot;  type=&quot;text/css&quot; href=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/esri/css/esri.css&quot; /&gt;</span><br><span class="line">    &lt;script  type=&quot;text/Javascript&quot; src=&quot;http://localhost/arcgis_js_api/library/3.17/3.17/init.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        require([&quot;esri/map&quot;,</span><br><span class="line">            &quot;dojo/dom&quot;,</span><br><span class="line">            &quot;dojo/on&quot;,</span><br><span class="line">            &quot;esri/layers/ArcGISDynamicMapServiceLayer&quot;,</span><br><span class="line">            &quot;esri/layers/FeatureLayer&quot;,</span><br><span class="line">            &quot;esri/layers/TableDataSource&quot;,</span><br><span class="line">            &quot;esri/layers/LayerDataSource&quot;,</span><br><span class="line">            &quot;esri/renderers/SimpleRenderer&quot;,</span><br><span class="line">            &quot;esri/symbols/SimpleLineSymbol&quot;,&quot;dojo/json&quot;,&quot;esri/tasks/query&quot;,</span><br><span class="line">            &quot;dojo/domReady!&quot;], function (</span><br><span class="line">                Map,dom,on, ArcGISDynamicMapServiceLayer, FeatureLayer, TableDataSource, LayerDataSource, SimpleRenderer,SimpleLineSymbol,jsonUtil,Query) &#123;</span><br><span class="line">            var map = new Map(&quot;mapDiv&quot;);</span><br><span class="line">            var layer1 = new ArcGISDynamicMapServiceLayer(&quot;http://localhost:6080/arcgis/rest/services//Test/MyService/MapServer&quot;);</span><br><span class="line">            map.addLayer(layer1);</span><br><span class="line"></span><br><span class="line">            on(dom.byId(&quot;btn&quot;),&quot;click&quot;,function(e)&#123;</span><br><span class="line">                //定义一个数据源</span><br><span class="line">                var dataSource = new TableDataSource();</span><br><span class="line">                //此处为我们设置的命名空间</span><br><span class="line">                dataSource.workspaceId = &quot;my&quot;;</span><br><span class="line">                //命名空间下面的shp</span><br><span class="line">                dataSource.dataSourceName = &quot;lunkuoxian.shp&quot;;</span><br><span class="line">                //定义一个图层数据源</span><br><span class="line">                var layerSource = new LayerDataSource();</span><br><span class="line">                //给图层数据源赋值</span><br><span class="line">                layerSource.dataSource = dataSource;</span><br><span class="line">                //定义一个要素图层:注意链接为动态图层的地址</span><br><span class="line">                var layer2 = new FeatureLayer(&quot;http://localhost:6080/arcgis/rest/services/Test/MyService/MapServer/dynamicLayer&quot;, &#123;</span><br><span class="line">                    mode: FeatureLayer.MODE_ONDEMAND,</span><br><span class="line">                    outFields: [&quot;*&quot;],</span><br><span class="line">                    source: layerSource</span><br><span class="line">                &#125;);</span><br><span class="line">                //定义线符号</span><br><span class="line">                var lineSymbol = new SimpleLineSymbol(SimpleLineSymbol.STYLE_DASH, new dojo.Color([255, 0, 0]), 3);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                var renderer = new esri.renderer.SimpleRenderer(lineSymbol);</span><br><span class="line">                //定义渲染器</span><br><span class="line">                layer2.setRenderer(renderer);</span><br><span class="line">                layer2.refresh();</span><br><span class="line">                map.addLayer(layer2);</span><br><span class="line">                on(dom.byId(&quot;attr&quot;),&quot;click&quot;,function()&#123;</span><br><span class="line">                    //得到要素图层的主键属性</span><br><span class="line">                    var idProperty = layer2.objectIdField;</span><br><span class="line">                    //定义查询参数</span><br><span class="line">                    var query = new Query();</span><br><span class="line">                    //是否返回几何形状</span><br><span class="line">                    query.returnGeometry = false;</span><br><span class="line">                    //图层的主键名称（根据自己要求修改）</span><br><span class="line">                    query.objectIds = [247];</span><br><span class="line">                    //查询条件1=1意思是：只根据主键查询，忽略where子句</span><br><span class="line">                    query.where = &quot;1=1&quot;;</span><br><span class="line">                    //进行查询</span><br><span class="line">                    layer2.selectFeatures(query, FeatureLayer.SELECTION_NEW,function(result)&#123;</span><br><span class="line">                        //因为我们根据主键查询，一定只有一个元素</span><br><span class="line">                        var graphic=result[0];</span><br><span class="line">                        //获得属性</span><br><span class="line">                        var attributes=graphic.attributes;</span><br><span class="line">                        //得到该属性信息转换成字符串</span><br><span class="line">                        var result=jsonUtil.stringify(attributes)</span><br><span class="line">                        //将结果弹出一下</span><br><span class="line">                        alert(result);</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;mapDiv&quot; style=&quot;height:600px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;添加动态图层&lt;/button&gt;</span><br><span class="line">&lt;button id=&quot;attr&quot;&gt;用户弹出属性&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><h4 id="启用文件地理数据库三点不同"><a href="#启用文件地理数据库三点不同" class="headerlink" title="启用文件地理数据库三点不同"></a>启用文件地理数据库三点不同</h4><p>文件的目录<br><img src="/2019/08/06/ArcGIS-API-for-JS18/12.png" alt="12.png"><br>命名空间配置<br><img src="/2019/08/06/ArcGIS-API-for-JS18/13.png" alt="13.png"><br>注册文件夹配置<br><img src="/2019/08/06/ArcGIS-API-for-JS18/14.png" alt="14.png"><br>代码调用差别<br><img src="/2019/08/06/ArcGIS-API-for-JS18/15.png" alt="15.png"><br>注意：忽略了要素集的存在，即调用是lunkuoxian，而不是vector.lunkuoxian，调用的时候后面没有*.shp</p>

                
                <div class="readmore">
                    <a href="/2019/08/06/ArcGIS-API-for-JS18/">
                        阅读更多
                    </a>
                </div>
            </div>
        
    </div>


    <div id="content-aside">
    <div class="content-aside-owner">
        <div id="owner">
    <div class="avatar-bg">
        <div class="index-page">
            <div class="banner">
                <div class="slide slide1">
                    <div class="bg-wrapper">
                        <div class="bg" id="container_left">
                            <div id="canvas_left"></div>
                        </div>
                    </div>
                </div>
                <div class="slide slide2">
                    <div class="bg-wrapper">
                        <div class="bg" id="container_right">
                            <div id="canvas_right"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a href="/"><img class="avatar" src="/images/avatar.jpg" alt=""></a>
    <a href="/"><h3 class="author">I&#39;m xiedandan</h3></a>
    <h4>^_^</h4>
    <div class="social">
        
            
              <a href="https://github.com/xdd7130" title="github" class="fa fa-github" target="_blank"></a>
            
        
            
              <a href="#" title="weibo" class="fa fa-weibo" target="_blank"></a>
            
        
    </div>
</div>
    </div>
    
        <div class="content-aside-about">
            <h2>
                <a href="/about">关于</a>
            </h2>
        </div>
    
    <div class="content-aside-tags">
        <h2>
            <a href="/tags">
                标签
                <sup style="font-size: 12px">
                    [29]
                </sup>
            </a>
        </h2>
    </div>
    
<aside id="categories">
    <h2>分类</h2>
    
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cesium/">Cesium</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node/">Node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VUE/">VUE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/基础前端技术/">基础前端技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/小程序/">小程序</a></li></ul>
    
</aside>

    
<aside id="acchives">
    <h2>归档</h2>
    
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li></ul>
    
</aside>

</div>

</div>
<nav id="pagination" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/">下一页 &raquo;</a>
</nav>

    </div>
</div>
<footer id="footer">
     <div id="copyright">&copy; I&#39;m xiedandan  2020</div>
     
             <!-- 不蒜子统计 -->
             <span id="busuanzi_container_site_pv">
                     本站总访问量<span id="busuanzi_value_site_pv" style='color:#17a167'></span>次
             </span>
             <span class="post-meta-divider">|</span>
             <span id="busuanzi_container_site_uv">
                     本站访客数<span id="busuanzi_value_site_uv"  style='color:#17a167'></span>人
             </span>
             <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
       
    <div id="theme">
        Powered by <a href="http://hexo.io">Hexo</a>. Theme by <a href="https://github.com/markyong/hexo-theme-stage">Stage</a>
    </div>
</footer>
<script src="/lib/js/waterrippleeffect.min.js"></script>
<script src="/js/header-bg.main.js"></script>

    <script src="/lib/js/cav.js"></script>
    <script src="/js/avatar-bg.main.js"></script>

</body>
</html>
